"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/audit/route";
exports.ids = ["app/api/audit/route"];
exports.modules = {

/***/ "@aws-sdk/client-s3":
/*!*************************************!*\
  !*** external "@aws-sdk/client-s3" ***!
  \*************************************/
/***/ ((module) => {

module.exports = require("@aws-sdk/client-s3");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2Froute&page=%2Fapi%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2Froute&page=%2Fapi%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_juliangarritz_dev_py_veraset_veraset_api_app_api_audit_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/audit/route.ts */ \"(rsc)/./app/api/audit/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/audit/route\",\n        pathname: \"/api/audit\",\n        filename: \"route\",\n        bundlePath: \"app/api/audit/route\"\n    },\n    resolvedPagePath: \"/Users/juliangarritz/dev/py/veraset/veraset-api/app/api/audit/route.ts\",\n    nextConfigOutput,\n    userland: _Users_juliangarritz_dev_py_veraset_veraset_api_app_api_audit_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/audit/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdWRpdCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYXVkaXQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhdWRpdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmp1bGlhbmdhcnJpdHolMkZkZXYlMkZweSUyRnZlcmFzZXQlMkZ2ZXJhc2V0LWFwaSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZqdWxpYW5nYXJyaXR6JTJGZGV2JTJGcHklMkZ2ZXJhc2V0JTJGdmVyYXNldC1hcGkmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3NCO0FBQ25HO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLz9hOGJkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9qdWxpYW5nYXJyaXR6L2Rldi9weS92ZXJhc2V0L3ZlcmFzZXQtYXBpL2FwcC9hcGkvYXVkaXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1ZGl0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXVkaXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1ZGl0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2p1bGlhbmdhcnJpdHovZGV2L3B5L3ZlcmFzZXQvdmVyYXNldC1hcGkvYXBwL2FwaS9hdWRpdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXVkaXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2Froute&page=%2Fapi%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/audit/route.ts":
/*!********************************!*\
  !*** ./app/api/audit/route.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   dynamic: () => (/* binding */ dynamic),\n/* harmony export */   revalidate: () => (/* binding */ revalidate)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_audit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/audit */ \"(rsc)/./lib/audit.ts\");\n\n\nconst dynamic = \"force-dynamic\";\nconst revalidate = 0;\nasync function GET(request) {\n    try {\n        const { searchParams } = new URL(request.url);\n        const type = searchParams.get(\"type\") || \"all\";\n        if (type === \"pois\") {\n            const results = await (0,_lib_audit__WEBPACK_IMPORTED_MODULE_1__.auditAllPOICollections)();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                type: \"pois\",\n                results,\n                summary: {\n                    total: results.length,\n                    withIssues: results.filter((r)=>r.issues.length > 0).length,\n                    totalDiscrepancy: results.reduce((sum, r)=>sum + Math.abs(r.discrepancy), 0)\n                }\n            });\n        } else if (type === \"jobs\") {\n            const results = await (0,_lib_audit__WEBPACK_IMPORTED_MODULE_1__.auditAllJobs)();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                type: \"jobs\",\n                results,\n                summary: {\n                    total: results.length,\n                    withIssues: results.filter((r)=>r.issues.length > 0).length,\n                    totalDiscrepancy: results.reduce((sum, r)=>sum + Math.abs(r.discrepancy), 0)\n                }\n            });\n        } else {\n            // Audit both\n            const [poiResults, jobResults] = await Promise.all([\n                (0,_lib_audit__WEBPACK_IMPORTED_MODULE_1__.auditAllPOICollections)(),\n                (0,_lib_audit__WEBPACK_IMPORTED_MODULE_1__.auditAllJobs)()\n            ]);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                type: \"all\",\n                pois: {\n                    results: poiResults,\n                    summary: {\n                        total: poiResults.length,\n                        withIssues: poiResults.filter((r)=>r.issues.length > 0).length,\n                        totalDiscrepancy: poiResults.reduce((sum, r)=>sum + Math.abs(r.discrepancy), 0)\n                    }\n                },\n                jobs: {\n                    results: jobResults,\n                    summary: {\n                        total: jobResults.length,\n                        withIssues: jobResults.filter((r)=>r.issues.length > 0).length,\n                        totalDiscrepancy: jobResults.reduce((sum, r)=>sum + Math.abs(r.discrepancy), 0)\n                    }\n                }\n            });\n        }\n    } catch (error) {\n        console.error(\"Audit error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to run audit\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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PzVjYmEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgYXVkaXRBbGxQT0lDb2xsZWN0aW9ucywgYXVkaXRBbGxKb2JzIH0gZnJvbSBcIkAvbGliL2F1ZGl0XCI7XG5cbmV4cG9ydCBjb25zdCBkeW5hbWljID0gJ2ZvcmNlLWR5bmFtaWMnO1xuZXhwb3J0IGNvbnN0IHJldmFsaWRhdGUgPSAwO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IHR5cGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0eXBlJykgfHwgJ2FsbCc7XG4gICAgXG4gICAgaWYgKHR5cGUgPT09ICdwb2lzJykge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGF1ZGl0QWxsUE9JQ29sbGVjdGlvbnMoKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHR5cGU6ICdwb2lzJyxcbiAgICAgICAgcmVzdWx0cyxcbiAgICAgICAgc3VtbWFyeToge1xuICAgICAgICAgIHRvdGFsOiByZXN1bHRzLmxlbmd0aCxcbiAgICAgICAgICB3aXRoSXNzdWVzOiByZXN1bHRzLmZpbHRlcihyID0+IHIuaXNzdWVzLmxlbmd0aCA+IDApLmxlbmd0aCxcbiAgICAgICAgICB0b3RhbERpc2NyZXBhbmN5OiByZXN1bHRzLnJlZHVjZSgoc3VtLCByKSA9PiBzdW0gKyBNYXRoLmFicyhyLmRpc2NyZXBhbmN5KSwgMCksXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdqb2JzJykge1xuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGF1ZGl0QWxsSm9icygpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgdHlwZTogJ2pvYnMnLFxuICAgICAgICByZXN1bHRzLFxuICAgICAgICBzdW1tYXJ5OiB7XG4gICAgICAgICAgdG90YWw6IHJlc3VsdHMubGVuZ3RoLFxuICAgICAgICAgIHdpdGhJc3N1ZXM6IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5pc3N1ZXMubGVuZ3RoID4gMCkubGVuZ3RoLFxuICAgICAgICAgIHRvdGFsRGlzY3JlcGFuY3k6IHJlc3VsdHMucmVkdWNlKChzdW0sIHIpID0+IHN1bSArIE1hdGguYWJzKHIuZGlzY3JlcGFuY3kpLCAwKSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBdWRpdCBib3RoXG4gICAgICBjb25zdCBbcG9pUmVzdWx0cywgam9iUmVzdWx0c10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICAgIGF1ZGl0QWxsUE9JQ29sbGVjdGlvbnMoKSxcbiAgICAgICAgYXVkaXRBbGxKb2JzKCksXG4gICAgICBdKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgdHlwZTogJ2FsbCcsXG4gICAgICAgIHBvaXM6IHtcbiAgICAgICAgICByZXN1bHRzOiBwb2lSZXN1bHRzLFxuICAgICAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgICAgIHRvdGFsOiBwb2lSZXN1bHRzLmxlbmd0aCxcbiAgICAgICAgICAgIHdpdGhJc3N1ZXM6IHBvaVJlc3VsdHMuZmlsdGVyKHIgPT4gci5pc3N1ZXMubGVuZ3RoID4gMCkubGVuZ3RoLFxuICAgICAgICAgICAgdG90YWxEaXNjcmVwYW5jeTogcG9pUmVzdWx0cy5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgTWF0aC5hYnMoci5kaXNjcmVwYW5jeSksIDApLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGpvYnM6IHtcbiAgICAgICAgICByZXN1bHRzOiBqb2JSZXN1bHRzLFxuICAgICAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgICAgIHRvdGFsOiBqb2JSZXN1bHRzLmxlbmd0aCxcbiAgICAgICAgICAgIHdpdGhJc3N1ZXM6IGpvYlJlc3VsdHMuZmlsdGVyKHIgPT4gci5pc3N1ZXMubGVuZ3RoID4gMCkubGVuZ3RoLFxuICAgICAgICAgICAgdG90YWxEaXNjcmVwYW5jeTogam9iUmVzdWx0cy5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgTWF0aC5hYnMoci5kaXNjcmVwYW5jeSksIDApLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBdWRpdCBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBydW4gYXVkaXQnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiYXVkaXRBbGxQT0lDb2xsZWN0aW9ucyIsImF1ZGl0QWxsSm9icyIsImR5bmFtaWMiLCJyZXZhbGlkYXRlIiwiR0VUIiwicmVxdWVzdCIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsInR5cGUiLCJnZXQiLCJyZXN1bHRzIiwianNvbiIsInN1bW1hcnkiLCJ0b3RhbCIsImxlbmd0aCIsIndpdGhJc3N1ZXMiLCJmaWx0ZXIiLCJyIiwiaXNzdWVzIiwidG90YWxEaXNjcmVwYW5jeSIsInJlZHVjZSIsInN1bSIsIk1hdGgiLCJhYnMiLCJkaXNjcmVwYW5jeSIsInBvaVJlc3VsdHMiLCJqb2JSZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsInBvaXMiLCJqb2JzIiwiZXJyb3IiLCJjb25zb2xlIiwiZGV0YWlscyIsIm1lc3NhZ2UiLCJzdGF0dXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/audit/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/audit.ts":
/*!**********************!*\
  !*** ./lib/audit.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   auditAllJobs: () => (/* binding */ auditAllJobs),\n/* harmony export */   auditAllPOICollections: () => (/* binding */ auditAllPOICollections),\n/* harmony export */   auditJob: () => (/* binding */ auditJob),\n/* harmony export */   auditPOICollection: () => (/* binding */ auditPOICollection)\n/* harmony export */ });\n/* harmony import */ var _s3_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./s3-config */ \"(rsc)/./lib/s3-config.ts\");\n/* harmony import */ var _jobs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./jobs */ \"(rsc)/./lib/jobs.ts\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_2__);\n/**\n * Audit utilities to verify data integrity\n */ \n\n\n\n/**\n * Audit a POI collection to verify POI count matches\n */ async function auditPOICollection(collectionId) {\n    const issues = [];\n    try {\n        // Get collection metadata\n        const { getConfig } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ./s3-config */ \"(rsc)/./lib/s3-config.ts\"));\n        const collections = await getConfig(\"poi-collections\") || {};\n        const collection = collections[collectionId];\n        if (!collection) {\n            return {\n                collectionId,\n                collectionName: \"Unknown\",\n                expectedCount: 0,\n                actualCount: 0,\n                validPoints: 0,\n                invalidFeatures: 0,\n                discrepancy: 0,\n                issues: [\n                    `Collection ${collectionId} not found`\n                ]\n            };\n        }\n        const expectedCount = collection.poiCount || 0;\n        // Load GeoJSON\n        const geojson = await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.getPOICollection)(collectionId);\n        if (!geojson) {\n            return {\n                collectionId,\n                collectionName: collection.name,\n                expectedCount,\n                actualCount: 0,\n                validPoints: 0,\n                invalidFeatures: 0,\n                discrepancy: expectedCount,\n                issues: [\n                    `GeoJSON file not found for collection ${collectionId}`\n                ]\n            };\n        }\n        const totalFeatures = geojson.features?.length || 0;\n        // Count valid Point features\n        const validPoints = (geojson.features || []).filter((f)=>{\n            return f.geometry && f.geometry.type === \"Point\" && Array.isArray(f.geometry.coordinates) && f.geometry.coordinates.length >= 2 && typeof f.geometry.coordinates[0] === \"number\" && typeof f.geometry.coordinates[1] === \"number\" && !isNaN(f.geometry.coordinates[0]) && !isNaN(f.geometry.coordinates[1]) && f.geometry.coordinates[0] >= -180 && f.geometry.coordinates[0] <= 180 && f.geometry.coordinates[1] >= -90 && f.geometry.coordinates[1] <= 90;\n        }).length;\n        const invalidFeatures = totalFeatures - validPoints;\n        const discrepancy = expectedCount - validPoints;\n        if (discrepancy !== 0) {\n            issues.push(`POI count mismatch: Expected ${expectedCount}, found ${validPoints} valid points (${totalFeatures} total features, ${invalidFeatures} invalid)`);\n        }\n        if (invalidFeatures > 0) {\n            issues.push(`${invalidFeatures} invalid features found (non-Point geometry or invalid coordinates)`);\n        }\n        return {\n            collectionId,\n            collectionName: collection.name,\n            expectedCount,\n            actualCount: totalFeatures,\n            validPoints,\n            invalidFeatures,\n            discrepancy,\n            issues\n        };\n    } catch (error) {\n        return {\n            collectionId,\n            collectionName: \"Unknown\",\n            expectedCount: 0,\n            actualCount: 0,\n            validPoints: 0,\n            invalidFeatures: 0,\n            discrepancy: 0,\n            issues: [\n                `Error auditing collection: ${error.message}`\n            ]\n        };\n    }\n}\n/**\n * Audit a job to verify date partitions match expected date range\n */ async function auditJob(jobId) {\n    const issues = [];\n    try {\n        const jobs = await (0,_jobs__WEBPACK_IMPORTED_MODULE_1__.getAllJobs)();\n        const job = jobs.find((j)=>j.jobId === jobId);\n        if (!job) {\n            return {\n                jobId,\n                jobName: \"Unknown\",\n                expectedDays: 0,\n                actualPartitions: 0,\n                partitionDates: [],\n                expectedDateRange: {\n                    from: \"\",\n                    to: \"\"\n                },\n                discrepancy: 0,\n                issues: [\n                    `Job ${jobId} not found`\n                ]\n            };\n        }\n        const dateRange = job.dateRange;\n        if (!dateRange || !dateRange.from || !dateRange.to) {\n            return {\n                jobId,\n                jobName: job.name,\n                expectedDays: 0,\n                actualPartitions: 0,\n                partitionDates: [],\n                expectedDateRange: {\n                    from: \"\",\n                    to: \"\"\n                },\n                discrepancy: 0,\n                issues: [\n                    `Job ${jobId} has no date range`\n                ]\n            };\n        }\n        const fromDate = new Date(dateRange.from);\n        const toDate = new Date(dateRange.to);\n        const expectedDays = Math.ceil((toDate.getTime() - fromDate.getTime()) / (1000 * 60 * 60 * 24)) + 1;\n        // Discover partitions from S3\n        const datasetName = jobId;\n        const prefix = `${datasetName}/`;\n        const partitions = new Set();\n        try {\n            let continuationToken;\n            do {\n                const listRes = await _s3_config__WEBPACK_IMPORTED_MODULE_0__.s3Client.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_2__.ListObjectsV2Command({\n                    Bucket: _s3_config__WEBPACK_IMPORTED_MODULE_0__.BUCKET,\n                    Prefix: prefix,\n                    Delimiter: \"/\"\n                }));\n                // Extract partition dates from common prefixes\n                if (listRes.CommonPrefixes) {\n                    for (const prefixObj of listRes.CommonPrefixes){\n                        const prefixPath = prefixObj.Prefix || \"\";\n                        const match = prefixPath.match(/date=(\\d{4}-\\d{2}-\\d{2})/);\n                        if (match) {\n                            partitions.add(match[1]);\n                        }\n                    }\n                }\n                // Also check individual objects for date patterns\n                if (listRes.Contents) {\n                    for (const obj of listRes.Contents){\n                        const key = obj.Key || \"\";\n                        const match = key.match(/date=(\\d{4}-\\d{2}-\\d{2})/);\n                        if (match) {\n                            partitions.add(match[1]);\n                        }\n                    }\n                }\n                continuationToken = listRes.NextContinuationToken;\n            }while (continuationToken);\n        } catch (error) {\n            issues.push(`Error discovering partitions from S3: ${error.message}`);\n        }\n        const partitionDates = Array.from(partitions).sort();\n        const actualPartitions = partitionDates.length;\n        const discrepancy = expectedDays - actualPartitions;\n        if (discrepancy !== 0) {\n            issues.push(`Date range mismatch: Expected ${expectedDays} days (${dateRange.from} to ${dateRange.to}), found ${actualPartitions} partitions`);\n        }\n        // Check if partition dates match expected range\n        if (partitionDates.length > 0) {\n            const firstPartition = partitionDates[0];\n            const lastPartition = partitionDates[partitionDates.length - 1];\n            if (firstPartition !== dateRange.from) {\n                issues.push(`First partition date (${firstPartition}) does not match start date (${dateRange.from})`);\n            }\n            if (lastPartition !== dateRange.to) {\n                issues.push(`Last partition date (${lastPartition}) does not match end date (${dateRange.to})`);\n            }\n        }\n        return {\n            jobId,\n            jobName: job.name,\n            expectedDays,\n            actualPartitions,\n            partitionDates,\n            expectedDateRange: dateRange,\n            discrepancy,\n            issues\n        };\n    } catch (error) {\n        return {\n            jobId,\n            jobName: \"Unknown\",\n            expectedDays: 0,\n            actualPartitions: 0,\n            partitionDates: [],\n            expectedDateRange: {\n                from: \"\",\n                to: \"\"\n            },\n            discrepancy: 0,\n            issues: [\n                `Error auditing job: ${error.message}`\n            ]\n        };\n    }\n}\n/**\n * Audit all POI collections\n */ async function auditAllPOICollections() {\n    const { getConfig } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! ./s3-config */ \"(rsc)/./lib/s3-config.ts\"));\n    const collections = await getConfig(\"poi-collections\") || {};\n    const collectionIds = Object.keys(collections);\n    const results = await Promise.all(collectionIds.map((id)=>auditPOICollection(id)));\n    return results;\n}\n/**\n * Audit all jobs\n */ async function auditAllJobs() {\n    const jobs = await (0,_jobs__WEBPACK_IMPORTED_MODULE_1__.getAllJobs)();\n    const results = await Promise.all(jobs.map((job)=>auditJob(job.jobId)));\n    return results;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXVkaXQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7Q0FFQyxHQUU4QztBQUNYO0FBQ3NCO0FBQ1g7QUF3Qi9DOztDQUVDLEdBQ00sZUFBZUssbUJBQW1CQyxZQUFvQjtJQUMzRCxNQUFNQyxTQUFtQixFQUFFO0lBRTNCLElBQUk7UUFDRiwwQkFBMEI7UUFDMUIsTUFBTSxFQUFFQyxTQUFTLEVBQUUsR0FBRyxNQUFNLG1JQUFPO1FBQ25DLE1BQU1DLGNBQWMsTUFBTUQsVUFBK0Isc0JBQXNCLENBQUM7UUFDaEYsTUFBTUUsYUFBYUQsV0FBVyxDQUFDSCxhQUFhO1FBRTVDLElBQUksQ0FBQ0ksWUFBWTtZQUNmLE9BQU87Z0JBQ0xKO2dCQUNBSyxnQkFBZ0I7Z0JBQ2hCQyxlQUFlO2dCQUNmQyxhQUFhO2dCQUNiQyxhQUFhO2dCQUNiQyxpQkFBaUI7Z0JBQ2pCQyxhQUFhO2dCQUNiVCxRQUFRO29CQUFDLENBQUMsV0FBVyxFQUFFRCxhQUFhLFVBQVUsQ0FBQztpQkFBQztZQUNsRDtRQUNGO1FBRUEsTUFBTU0sZ0JBQWdCRixXQUFXTyxRQUFRLElBQUk7UUFFN0MsZUFBZTtRQUNmLE1BQU1DLFVBQVUsTUFBTWxCLDREQUFnQkEsQ0FBQ007UUFFdkMsSUFBSSxDQUFDWSxTQUFTO1lBQ1osT0FBTztnQkFDTFo7Z0JBQ0FLLGdCQUFnQkQsV0FBV1MsSUFBSTtnQkFDL0JQO2dCQUNBQyxhQUFhO2dCQUNiQyxhQUFhO2dCQUNiQyxpQkFBaUI7Z0JBQ2pCQyxhQUFhSjtnQkFDYkwsUUFBUTtvQkFBQyxDQUFDLHNDQUFzQyxFQUFFRCxhQUFhLENBQUM7aUJBQUM7WUFDbkU7UUFDRjtRQUVBLE1BQU1jLGdCQUFnQkYsUUFBUUcsUUFBUSxFQUFFQyxVQUFVO1FBRWxELDZCQUE2QjtRQUM3QixNQUFNUixjQUFjLENBQUNJLFFBQVFHLFFBQVEsSUFBSSxFQUFFLEVBQUVFLE1BQU0sQ0FBQyxDQUFDQztZQUNuRCxPQUNFQSxFQUFFQyxRQUFRLElBQ1ZELEVBQUVDLFFBQVEsQ0FBQ0MsSUFBSSxLQUFLLFdBQ3BCQyxNQUFNQyxPQUFPLENBQUNKLEVBQUVDLFFBQVEsQ0FBQ0ksV0FBVyxLQUNwQ0wsRUFBRUMsUUFBUSxDQUFDSSxXQUFXLENBQUNQLE1BQU0sSUFBSSxLQUNqQyxPQUFPRSxFQUFFQyxRQUFRLENBQUNJLFdBQVcsQ0FBQyxFQUFFLEtBQUssWUFDckMsT0FBT0wsRUFBRUMsUUFBUSxDQUFDSSxXQUFXLENBQUMsRUFBRSxLQUFLLFlBQ3JDLENBQUNDLE1BQU1OLEVBQUVDLFFBQVEsQ0FBQ0ksV0FBVyxDQUFDLEVBQUUsS0FDaEMsQ0FBQ0MsTUFBTU4sRUFBRUMsUUFBUSxDQUFDSSxXQUFXLENBQUMsRUFBRSxLQUNoQ0wsRUFBRUMsUUFBUSxDQUFDSSxXQUFXLENBQUMsRUFBRSxJQUFJLENBQUMsT0FDOUJMLEVBQUVDLFFBQVEsQ0FBQ0ksV0FBVyxDQUFDLEVBQUUsSUFBSSxPQUM3QkwsRUFBRUMsUUFBUSxDQUFDSSxXQUFXLENBQUMsRUFBRSxJQUFJLENBQUMsTUFDOUJMLEVBQUVDLFFBQVEsQ0FBQ0ksV0FBVyxDQUFDLEVBQUUsSUFBSTtRQUVqQyxHQUFHUCxNQUFNO1FBRVQsTUFBTVAsa0JBQWtCSyxnQkFBZ0JOO1FBQ3hDLE1BQU1FLGNBQWNKLGdCQUFnQkU7UUFFcEMsSUFBSUUsZ0JBQWdCLEdBQUc7WUFDckJULE9BQU93QixJQUFJLENBQ1QsQ0FBQyw2QkFBNkIsRUFBRW5CLGNBQWMsUUFBUSxFQUFFRSxZQUFZLGVBQWUsRUFBRU0sY0FBYyxpQkFBaUIsRUFBRUwsZ0JBQWdCLFNBQVMsQ0FBQztRQUVwSjtRQUVBLElBQUlBLGtCQUFrQixHQUFHO1lBQ3ZCUixPQUFPd0IsSUFBSSxDQUNULENBQUMsRUFBRWhCLGdCQUFnQixtRUFBbUUsQ0FBQztRQUUzRjtRQUVBLE9BQU87WUFDTFQ7WUFDQUssZ0JBQWdCRCxXQUFXUyxJQUFJO1lBQy9CUDtZQUNBQyxhQUFhTztZQUNiTjtZQUNBQztZQUNBQztZQUNBVDtRQUNGO0lBQ0YsRUFBRSxPQUFPeUIsT0FBWTtRQUNuQixPQUFPO1lBQ0wxQjtZQUNBSyxnQkFBZ0I7WUFDaEJDLGVBQWU7WUFDZkMsYUFBYTtZQUNiQyxhQUFhO1lBQ2JDLGlCQUFpQjtZQUNqQkMsYUFBYTtZQUNiVCxRQUFRO2dCQUFDLENBQUMsMkJBQTJCLEVBQUV5QixNQUFNQyxPQUFPLENBQUMsQ0FBQzthQUFDO1FBQ3pEO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZUMsU0FBU0MsS0FBYTtJQUMxQyxNQUFNNUIsU0FBbUIsRUFBRTtJQUUzQixJQUFJO1FBQ0YsTUFBTTZCLE9BQU8sTUFBTW5DLGlEQUFVQTtRQUM3QixNQUFNb0MsTUFBTUQsS0FBS0UsSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFSixLQUFLLEtBQUtBO1FBRXZDLElBQUksQ0FBQ0UsS0FBSztZQUNSLE9BQU87Z0JBQ0xGO2dCQUNBSyxTQUFTO2dCQUNUQyxjQUFjO2dCQUNkQyxrQkFBa0I7Z0JBQ2xCQyxnQkFBZ0IsRUFBRTtnQkFDbEJDLG1CQUFtQjtvQkFBRUMsTUFBTTtvQkFBSUMsSUFBSTtnQkFBRztnQkFDdEM5QixhQUFhO2dCQUNiVCxRQUFRO29CQUFDLENBQUMsSUFBSSxFQUFFNEIsTUFBTSxVQUFVLENBQUM7aUJBQUM7WUFDcEM7UUFDRjtRQUVBLE1BQU1ZLFlBQVlWLElBQUlVLFNBQVM7UUFDL0IsSUFBSSxDQUFDQSxhQUFhLENBQUNBLFVBQVVGLElBQUksSUFBSSxDQUFDRSxVQUFVRCxFQUFFLEVBQUU7WUFDbEQsT0FBTztnQkFDTFg7Z0JBQ0FLLFNBQVNILElBQUlsQixJQUFJO2dCQUNqQnNCLGNBQWM7Z0JBQ2RDLGtCQUFrQjtnQkFDbEJDLGdCQUFnQixFQUFFO2dCQUNsQkMsbUJBQW1CO29CQUFFQyxNQUFNO29CQUFJQyxJQUFJO2dCQUFHO2dCQUN0QzlCLGFBQWE7Z0JBQ2JULFFBQVE7b0JBQUMsQ0FBQyxJQUFJLEVBQUU0QixNQUFNLGtCQUFrQixDQUFDO2lCQUFDO1lBQzVDO1FBQ0Y7UUFFQSxNQUFNYSxXQUFXLElBQUlDLEtBQUtGLFVBQVVGLElBQUk7UUFDeEMsTUFBTUssU0FBUyxJQUFJRCxLQUFLRixVQUFVRCxFQUFFO1FBQ3BDLE1BQU1MLGVBQWVVLEtBQUtDLElBQUksQ0FBQyxDQUFDRixPQUFPRyxPQUFPLEtBQUtMLFNBQVNLLE9BQU8sRUFBQyxJQUFNLFFBQU8sS0FBSyxLQUFLLEVBQUMsS0FBTTtRQUVsRyw4QkFBOEI7UUFDOUIsTUFBTUMsY0FBY25CO1FBQ3BCLE1BQU1vQixTQUFTLENBQUMsRUFBRUQsWUFBWSxDQUFDLENBQUM7UUFDaEMsTUFBTUUsYUFBYSxJQUFJQztRQUV2QixJQUFJO1lBQ0YsSUFBSUM7WUFFSixHQUFHO2dCQUNELE1BQU1DLFVBQVUsTUFBTXhELGdEQUFRQSxDQUFDeUQsSUFBSSxDQUFDLElBQUkxRCxvRUFBb0JBLENBQUM7b0JBQzNEMkQsUUFBUXpELDhDQUFNQTtvQkFDZDBELFFBQVFQO29CQUNSUSxXQUFXO2dCQUNiO2dCQUVBLCtDQUErQztnQkFDL0MsSUFBSUosUUFBUUssY0FBYyxFQUFFO29CQUMxQixLQUFLLE1BQU1DLGFBQWFOLFFBQVFLLGNBQWMsQ0FBRTt3QkFDOUMsTUFBTUUsYUFBYUQsVUFBVUgsTUFBTSxJQUFJO3dCQUN2QyxNQUFNSyxRQUFRRCxXQUFXQyxLQUFLLENBQUM7d0JBQy9CLElBQUlBLE9BQU87NEJBQ1RYLFdBQVdZLEdBQUcsQ0FBQ0QsS0FBSyxDQUFDLEVBQUU7d0JBQ3pCO29CQUNGO2dCQUNGO2dCQUVBLGtEQUFrRDtnQkFDbEQsSUFBSVIsUUFBUVUsUUFBUSxFQUFFO29CQUNwQixLQUFLLE1BQU1DLE9BQU9YLFFBQVFVLFFBQVEsQ0FBRTt3QkFDbEMsTUFBTUUsTUFBTUQsSUFBSUUsR0FBRyxJQUFJO3dCQUN2QixNQUFNTCxRQUFRSSxJQUFJSixLQUFLLENBQUM7d0JBQ3hCLElBQUlBLE9BQU87NEJBQ1RYLFdBQVdZLEdBQUcsQ0FBQ0QsS0FBSyxDQUFDLEVBQUU7d0JBQ3pCO29CQUNGO2dCQUNGO2dCQUVBVCxvQkFBb0JDLFFBQVFjLHFCQUFxQjtZQUNuRCxRQUFTZixtQkFBbUI7UUFDOUIsRUFBRSxPQUFPMUIsT0FBWTtZQUNuQnpCLE9BQU93QixJQUFJLENBQUMsQ0FBQyxzQ0FBc0MsRUFBRUMsTUFBTUMsT0FBTyxDQUFDLENBQUM7UUFDdEU7UUFFQSxNQUFNVSxpQkFBaUJoQixNQUFNa0IsSUFBSSxDQUFDVyxZQUFZa0IsSUFBSTtRQUNsRCxNQUFNaEMsbUJBQW1CQyxlQUFlckIsTUFBTTtRQUM5QyxNQUFNTixjQUFjeUIsZUFBZUM7UUFFbkMsSUFBSTFCLGdCQUFnQixHQUFHO1lBQ3JCVCxPQUFPd0IsSUFBSSxDQUNULENBQUMsOEJBQThCLEVBQUVVLGFBQWEsT0FBTyxFQUFFTSxVQUFVRixJQUFJLENBQUMsSUFBSSxFQUFFRSxVQUFVRCxFQUFFLENBQUMsU0FBUyxFQUFFSixpQkFBaUIsV0FBVyxDQUFDO1FBRXJJO1FBRUEsZ0RBQWdEO1FBQ2hELElBQUlDLGVBQWVyQixNQUFNLEdBQUcsR0FBRztZQUM3QixNQUFNcUQsaUJBQWlCaEMsY0FBYyxDQUFDLEVBQUU7WUFDeEMsTUFBTWlDLGdCQUFnQmpDLGNBQWMsQ0FBQ0EsZUFBZXJCLE1BQU0sR0FBRyxFQUFFO1lBRS9ELElBQUlxRCxtQkFBbUI1QixVQUFVRixJQUFJLEVBQUU7Z0JBQ3JDdEMsT0FBT3dCLElBQUksQ0FDVCxDQUFDLHNCQUFzQixFQUFFNEMsZUFBZSw2QkFBNkIsRUFBRTVCLFVBQVVGLElBQUksQ0FBQyxDQUFDLENBQUM7WUFFNUY7WUFFQSxJQUFJK0Isa0JBQWtCN0IsVUFBVUQsRUFBRSxFQUFFO2dCQUNsQ3ZDLE9BQU93QixJQUFJLENBQ1QsQ0FBQyxxQkFBcUIsRUFBRTZDLGNBQWMsMkJBQTJCLEVBQUU3QixVQUFVRCxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBRXRGO1FBQ0Y7UUFFQSxPQUFPO1lBQ0xYO1lBQ0FLLFNBQVNILElBQUlsQixJQUFJO1lBQ2pCc0I7WUFDQUM7WUFDQUM7WUFDQUMsbUJBQW1CRztZQUNuQi9CO1lBQ0FUO1FBQ0Y7SUFDRixFQUFFLE9BQU95QixPQUFZO1FBQ25CLE9BQU87WUFDTEc7WUFDQUssU0FBUztZQUNUQyxjQUFjO1lBQ2RDLGtCQUFrQjtZQUNsQkMsZ0JBQWdCLEVBQUU7WUFDbEJDLG1CQUFtQjtnQkFBRUMsTUFBTTtnQkFBSUMsSUFBSTtZQUFHO1lBQ3RDOUIsYUFBYTtZQUNiVCxRQUFRO2dCQUFDLENBQUMsb0JBQW9CLEVBQUV5QixNQUFNQyxPQUFPLENBQUMsQ0FBQzthQUFDO1FBQ2xEO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sZUFBZTRDO0lBQ3BCLE1BQU0sRUFBRXJFLFNBQVMsRUFBRSxHQUFHLE1BQU0sbUlBQU87SUFDbkMsTUFBTUMsY0FBYyxNQUFNRCxVQUErQixzQkFBc0IsQ0FBQztJQUNoRixNQUFNc0UsZ0JBQWdCQyxPQUFPQyxJQUFJLENBQUN2RTtJQUVsQyxNQUFNd0UsVUFBVSxNQUFNQyxRQUFRQyxHQUFHLENBQy9CTCxjQUFjTSxHQUFHLENBQUNDLENBQUFBLEtBQU1oRixtQkFBbUJnRjtJQUc3QyxPQUFPSjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlSztJQUNwQixNQUFNbEQsT0FBTyxNQUFNbkMsaURBQVVBO0lBRTdCLE1BQU1nRixVQUFVLE1BQU1DLFFBQVFDLEdBQUcsQ0FDL0IvQyxLQUFLZ0QsR0FBRyxDQUFDL0MsQ0FBQUEsTUFBT0gsU0FBU0csSUFBSUYsS0FBSztJQUdwQyxPQUFPOEM7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL2dtYy12ZXJhc2V0LWFwaS8uL2xpYi9hdWRpdC50cz9iM2VlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXVkaXQgdXRpbGl0aWVzIHRvIHZlcmlmeSBkYXRhIGludGVncml0eVxuICovXG5cbmltcG9ydCB7IGdldFBPSUNvbGxlY3Rpb24gfSBmcm9tICcuL3MzLWNvbmZpZyc7XG5pbXBvcnQgeyBnZXRBbGxKb2JzIH0gZnJvbSAnLi9qb2JzJztcbmltcG9ydCB7IExpc3RPYmplY3RzVjJDb21tYW5kIH0gZnJvbSAnQGF3cy1zZGsvY2xpZW50LXMzJztcbmltcG9ydCB7IHMzQ2xpZW50LCBCVUNLRVQgfSBmcm9tICcuL3MzLWNvbmZpZyc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUE9JQXVkaXRSZXN1bHQge1xuICBjb2xsZWN0aW9uSWQ6IHN0cmluZztcbiAgY29sbGVjdGlvbk5hbWU6IHN0cmluZztcbiAgZXhwZWN0ZWRDb3VudDogbnVtYmVyO1xuICBhY3R1YWxDb3VudDogbnVtYmVyO1xuICB2YWxpZFBvaW50czogbnVtYmVyO1xuICBpbnZhbGlkRmVhdHVyZXM6IG51bWJlcjtcbiAgZGlzY3JlcGFuY3k6IG51bWJlcjtcbiAgaXNzdWVzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBKb2JBdWRpdFJlc3VsdCB7XG4gIGpvYklkOiBzdHJpbmc7XG4gIGpvYk5hbWU6IHN0cmluZztcbiAgZXhwZWN0ZWREYXlzOiBudW1iZXI7XG4gIGFjdHVhbFBhcnRpdGlvbnM6IG51bWJlcjtcbiAgcGFydGl0aW9uRGF0ZXM6IHN0cmluZ1tdO1xuICBleHBlY3RlZERhdGVSYW5nZTogeyBmcm9tOiBzdHJpbmc7IHRvOiBzdHJpbmcgfTtcbiAgZGlzY3JlcGFuY3k6IG51bWJlcjtcbiAgaXNzdWVzOiBzdHJpbmdbXTtcbn1cblxuLyoqXG4gKiBBdWRpdCBhIFBPSSBjb2xsZWN0aW9uIHRvIHZlcmlmeSBQT0kgY291bnQgbWF0Y2hlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaXRQT0lDb2xsZWN0aW9uKGNvbGxlY3Rpb25JZDogc3RyaW5nKTogUHJvbWlzZTxQT0lBdWRpdFJlc3VsdD4ge1xuICBjb25zdCBpc3N1ZXM6IHN0cmluZ1tdID0gW107XG4gIFxuICB0cnkge1xuICAgIC8vIEdldCBjb2xsZWN0aW9uIG1ldGFkYXRhXG4gICAgY29uc3QgeyBnZXRDb25maWcgfSA9IGF3YWl0IGltcG9ydCgnLi9zMy1jb25maWcnKTtcbiAgICBjb25zdCBjb2xsZWN0aW9ucyA9IGF3YWl0IGdldENvbmZpZzxSZWNvcmQ8c3RyaW5nLCBhbnk+PigncG9pLWNvbGxlY3Rpb25zJykgfHwge307XG4gICAgY29uc3QgY29sbGVjdGlvbiA9IGNvbGxlY3Rpb25zW2NvbGxlY3Rpb25JZF07XG4gICAgXG4gICAgaWYgKCFjb2xsZWN0aW9uKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjb2xsZWN0aW9uSWQsXG4gICAgICAgIGNvbGxlY3Rpb25OYW1lOiAnVW5rbm93bicsXG4gICAgICAgIGV4cGVjdGVkQ291bnQ6IDAsXG4gICAgICAgIGFjdHVhbENvdW50OiAwLFxuICAgICAgICB2YWxpZFBvaW50czogMCxcbiAgICAgICAgaW52YWxpZEZlYXR1cmVzOiAwLFxuICAgICAgICBkaXNjcmVwYW5jeTogMCxcbiAgICAgICAgaXNzdWVzOiBbYENvbGxlY3Rpb24gJHtjb2xsZWN0aW9uSWR9IG5vdCBmb3VuZGBdLFxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZXhwZWN0ZWRDb3VudCA9IGNvbGxlY3Rpb24ucG9pQ291bnQgfHwgMDtcbiAgICBcbiAgICAvLyBMb2FkIEdlb0pTT05cbiAgICBjb25zdCBnZW9qc29uID0gYXdhaXQgZ2V0UE9JQ29sbGVjdGlvbihjb2xsZWN0aW9uSWQpO1xuICAgIFxuICAgIGlmICghZ2VvanNvbikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY29sbGVjdGlvbklkLFxuICAgICAgICBjb2xsZWN0aW9uTmFtZTogY29sbGVjdGlvbi5uYW1lLFxuICAgICAgICBleHBlY3RlZENvdW50LFxuICAgICAgICBhY3R1YWxDb3VudDogMCxcbiAgICAgICAgdmFsaWRQb2ludHM6IDAsXG4gICAgICAgIGludmFsaWRGZWF0dXJlczogMCxcbiAgICAgICAgZGlzY3JlcGFuY3k6IGV4cGVjdGVkQ291bnQsXG4gICAgICAgIGlzc3VlczogW2BHZW9KU09OIGZpbGUgbm90IGZvdW5kIGZvciBjb2xsZWN0aW9uICR7Y29sbGVjdGlvbklkfWBdLFxuICAgICAgfTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgdG90YWxGZWF0dXJlcyA9IGdlb2pzb24uZmVhdHVyZXM/Lmxlbmd0aCB8fCAwO1xuICAgIFxuICAgIC8vIENvdW50IHZhbGlkIFBvaW50IGZlYXR1cmVzXG4gICAgY29uc3QgdmFsaWRQb2ludHMgPSAoZ2VvanNvbi5mZWF0dXJlcyB8fCBbXSkuZmlsdGVyKChmOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIGYuZ2VvbWV0cnkgJiZcbiAgICAgICAgZi5nZW9tZXRyeS50eXBlID09PSAnUG9pbnQnICYmXG4gICAgICAgIEFycmF5LmlzQXJyYXkoZi5nZW9tZXRyeS5jb29yZGluYXRlcykgJiZcbiAgICAgICAgZi5nZW9tZXRyeS5jb29yZGluYXRlcy5sZW5ndGggPj0gMiAmJlxuICAgICAgICB0eXBlb2YgZi5nZW9tZXRyeS5jb29yZGluYXRlc1swXSA9PT0gJ251bWJlcicgJiZcbiAgICAgICAgdHlwZW9mIGYuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0gPT09ICdudW1iZXInICYmXG4gICAgICAgICFpc05hTihmLmdlb21ldHJ5LmNvb3JkaW5hdGVzWzBdKSAmJlxuICAgICAgICAhaXNOYU4oZi5nZW9tZXRyeS5jb29yZGluYXRlc1sxXSkgJiZcbiAgICAgICAgZi5nZW9tZXRyeS5jb29yZGluYXRlc1swXSA+PSAtMTgwICYmXG4gICAgICAgIGYuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMF0gPD0gMTgwICYmXG4gICAgICAgIGYuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0gPj0gLTkwICYmXG4gICAgICAgIGYuZ2VvbWV0cnkuY29vcmRpbmF0ZXNbMV0gPD0gOTBcbiAgICAgICk7XG4gICAgfSkubGVuZ3RoO1xuICAgIFxuICAgIGNvbnN0IGludmFsaWRGZWF0dXJlcyA9IHRvdGFsRmVhdHVyZXMgLSB2YWxpZFBvaW50cztcbiAgICBjb25zdCBkaXNjcmVwYW5jeSA9IGV4cGVjdGVkQ291bnQgLSB2YWxpZFBvaW50cztcbiAgICBcbiAgICBpZiAoZGlzY3JlcGFuY3kgIT09IDApIHtcbiAgICAgIGlzc3Vlcy5wdXNoKFxuICAgICAgICBgUE9JIGNvdW50IG1pc21hdGNoOiBFeHBlY3RlZCAke2V4cGVjdGVkQ291bnR9LCBmb3VuZCAke3ZhbGlkUG9pbnRzfSB2YWxpZCBwb2ludHMgKCR7dG90YWxGZWF0dXJlc30gdG90YWwgZmVhdHVyZXMsICR7aW52YWxpZEZlYXR1cmVzfSBpbnZhbGlkKWBcbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIGlmIChpbnZhbGlkRmVhdHVyZXMgPiAwKSB7XG4gICAgICBpc3N1ZXMucHVzaChcbiAgICAgICAgYCR7aW52YWxpZEZlYXR1cmVzfSBpbnZhbGlkIGZlYXR1cmVzIGZvdW5kIChub24tUG9pbnQgZ2VvbWV0cnkgb3IgaW52YWxpZCBjb29yZGluYXRlcylgXG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgY29sbGVjdGlvbklkLFxuICAgICAgY29sbGVjdGlvbk5hbWU6IGNvbGxlY3Rpb24ubmFtZSxcbiAgICAgIGV4cGVjdGVkQ291bnQsXG4gICAgICBhY3R1YWxDb3VudDogdG90YWxGZWF0dXJlcyxcbiAgICAgIHZhbGlkUG9pbnRzLFxuICAgICAgaW52YWxpZEZlYXR1cmVzLFxuICAgICAgZGlzY3JlcGFuY3ksXG4gICAgICBpc3N1ZXMsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiB7XG4gICAgICBjb2xsZWN0aW9uSWQsXG4gICAgICBjb2xsZWN0aW9uTmFtZTogJ1Vua25vd24nLFxuICAgICAgZXhwZWN0ZWRDb3VudDogMCxcbiAgICAgIGFjdHVhbENvdW50OiAwLFxuICAgICAgdmFsaWRQb2ludHM6IDAsXG4gICAgICBpbnZhbGlkRmVhdHVyZXM6IDAsXG4gICAgICBkaXNjcmVwYW5jeTogMCxcbiAgICAgIGlzc3VlczogW2BFcnJvciBhdWRpdGluZyBjb2xsZWN0aW9uOiAke2Vycm9yLm1lc3NhZ2V9YF0sXG4gICAgfTtcbiAgfVxufVxuXG4vKipcbiAqIEF1ZGl0IGEgam9iIHRvIHZlcmlmeSBkYXRlIHBhcnRpdGlvbnMgbWF0Y2ggZXhwZWN0ZWQgZGF0ZSByYW5nZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaXRKb2Ioam9iSWQ6IHN0cmluZyk6IFByb21pc2U8Sm9iQXVkaXRSZXN1bHQ+IHtcbiAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBqb2JzID0gYXdhaXQgZ2V0QWxsSm9icygpO1xuICAgIGNvbnN0IGpvYiA9IGpvYnMuZmluZChqID0+IGouam9iSWQgPT09IGpvYklkKTtcbiAgICBcbiAgICBpZiAoIWpvYikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgam9iSWQsXG4gICAgICAgIGpvYk5hbWU6ICdVbmtub3duJyxcbiAgICAgICAgZXhwZWN0ZWREYXlzOiAwLFxuICAgICAgICBhY3R1YWxQYXJ0aXRpb25zOiAwLFxuICAgICAgICBwYXJ0aXRpb25EYXRlczogW10sXG4gICAgICAgIGV4cGVjdGVkRGF0ZVJhbmdlOiB7IGZyb206ICcnLCB0bzogJycgfSxcbiAgICAgICAgZGlzY3JlcGFuY3k6IDAsXG4gICAgICAgIGlzc3VlczogW2BKb2IgJHtqb2JJZH0gbm90IGZvdW5kYF0sXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBkYXRlUmFuZ2UgPSBqb2IuZGF0ZVJhbmdlO1xuICAgIGlmICghZGF0ZVJhbmdlIHx8ICFkYXRlUmFuZ2UuZnJvbSB8fCAhZGF0ZVJhbmdlLnRvKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBqb2JJZCxcbiAgICAgICAgam9iTmFtZTogam9iLm5hbWUsXG4gICAgICAgIGV4cGVjdGVkRGF5czogMCxcbiAgICAgICAgYWN0dWFsUGFydGl0aW9uczogMCxcbiAgICAgICAgcGFydGl0aW9uRGF0ZXM6IFtdLFxuICAgICAgICBleHBlY3RlZERhdGVSYW5nZTogeyBmcm9tOiAnJywgdG86ICcnIH0sXG4gICAgICAgIGRpc2NyZXBhbmN5OiAwLFxuICAgICAgICBpc3N1ZXM6IFtgSm9iICR7am9iSWR9IGhhcyBubyBkYXRlIHJhbmdlYF0sXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBmcm9tRGF0ZSA9IG5ldyBEYXRlKGRhdGVSYW5nZS5mcm9tKTtcbiAgICBjb25zdCB0b0RhdGUgPSBuZXcgRGF0ZShkYXRlUmFuZ2UudG8pO1xuICAgIGNvbnN0IGV4cGVjdGVkRGF5cyA9IE1hdGguY2VpbCgodG9EYXRlLmdldFRpbWUoKSAtIGZyb21EYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpICsgMTtcbiAgICBcbiAgICAvLyBEaXNjb3ZlciBwYXJ0aXRpb25zIGZyb20gUzNcbiAgICBjb25zdCBkYXRhc2V0TmFtZSA9IGpvYklkO1xuICAgIGNvbnN0IHByZWZpeCA9IGAke2RhdGFzZXROYW1lfS9gO1xuICAgIGNvbnN0IHBhcnRpdGlvbnMgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICBcbiAgICB0cnkge1xuICAgICAgbGV0IGNvbnRpbnVhdGlvblRva2VuOiBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICBcbiAgICAgIGRvIHtcbiAgICAgICAgY29uc3QgbGlzdFJlcyA9IGF3YWl0IHMzQ2xpZW50LnNlbmQobmV3IExpc3RPYmplY3RzVjJDb21tYW5kKHtcbiAgICAgICAgICBCdWNrZXQ6IEJVQ0tFVCxcbiAgICAgICAgICBQcmVmaXg6IHByZWZpeCxcbiAgICAgICAgICBEZWxpbWl0ZXI6ICcvJyxcbiAgICAgICAgfSkpO1xuICAgICAgICBcbiAgICAgICAgLy8gRXh0cmFjdCBwYXJ0aXRpb24gZGF0ZXMgZnJvbSBjb21tb24gcHJlZml4ZXNcbiAgICAgICAgaWYgKGxpc3RSZXMuQ29tbW9uUHJlZml4ZXMpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHByZWZpeE9iaiBvZiBsaXN0UmVzLkNvbW1vblByZWZpeGVzKSB7XG4gICAgICAgICAgICBjb25zdCBwcmVmaXhQYXRoID0gcHJlZml4T2JqLlByZWZpeCB8fCAnJztcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gcHJlZml4UGF0aC5tYXRjaCgvZGF0ZT0oXFxkezR9LVxcZHsyfS1cXGR7Mn0pLyk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgcGFydGl0aW9ucy5hZGQobWF0Y2hbMV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWxzbyBjaGVjayBpbmRpdmlkdWFsIG9iamVjdHMgZm9yIGRhdGUgcGF0dGVybnNcbiAgICAgICAgaWYgKGxpc3RSZXMuQ29udGVudHMpIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IG9iaiBvZiBsaXN0UmVzLkNvbnRlbnRzKSB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBvYmouS2V5IHx8ICcnO1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBrZXkubWF0Y2goL2RhdGU9KFxcZHs0fS1cXGR7Mn0tXFxkezJ9KS8pO1xuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgIHBhcnRpdGlvbnMuYWRkKG1hdGNoWzFdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnRpbnVhdGlvblRva2VuID0gbGlzdFJlcy5OZXh0Q29udGludWF0aW9uVG9rZW47XG4gICAgICB9IHdoaWxlIChjb250aW51YXRpb25Ub2tlbik7XG4gICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgaXNzdWVzLnB1c2goYEVycm9yIGRpc2NvdmVyaW5nIHBhcnRpdGlvbnMgZnJvbSBTMzogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBwYXJ0aXRpb25EYXRlcyA9IEFycmF5LmZyb20ocGFydGl0aW9ucykuc29ydCgpO1xuICAgIGNvbnN0IGFjdHVhbFBhcnRpdGlvbnMgPSBwYXJ0aXRpb25EYXRlcy5sZW5ndGg7XG4gICAgY29uc3QgZGlzY3JlcGFuY3kgPSBleHBlY3RlZERheXMgLSBhY3R1YWxQYXJ0aXRpb25zO1xuICAgIFxuICAgIGlmIChkaXNjcmVwYW5jeSAhPT0gMCkge1xuICAgICAgaXNzdWVzLnB1c2goXG4gICAgICAgIGBEYXRlIHJhbmdlIG1pc21hdGNoOiBFeHBlY3RlZCAke2V4cGVjdGVkRGF5c30gZGF5cyAoJHtkYXRlUmFuZ2UuZnJvbX0gdG8gJHtkYXRlUmFuZ2UudG99KSwgZm91bmQgJHthY3R1YWxQYXJ0aXRpb25zfSBwYXJ0aXRpb25zYFxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgcGFydGl0aW9uIGRhdGVzIG1hdGNoIGV4cGVjdGVkIHJhbmdlXG4gICAgaWYgKHBhcnRpdGlvbkRhdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnN0IGZpcnN0UGFydGl0aW9uID0gcGFydGl0aW9uRGF0ZXNbMF07XG4gICAgICBjb25zdCBsYXN0UGFydGl0aW9uID0gcGFydGl0aW9uRGF0ZXNbcGFydGl0aW9uRGF0ZXMubGVuZ3RoIC0gMV07XG4gICAgICBcbiAgICAgIGlmIChmaXJzdFBhcnRpdGlvbiAhPT0gZGF0ZVJhbmdlLmZyb20pIHtcbiAgICAgICAgaXNzdWVzLnB1c2goXG4gICAgICAgICAgYEZpcnN0IHBhcnRpdGlvbiBkYXRlICgke2ZpcnN0UGFydGl0aW9ufSkgZG9lcyBub3QgbWF0Y2ggc3RhcnQgZGF0ZSAoJHtkYXRlUmFuZ2UuZnJvbX0pYFxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAobGFzdFBhcnRpdGlvbiAhPT0gZGF0ZVJhbmdlLnRvKSB7XG4gICAgICAgIGlzc3Vlcy5wdXNoKFxuICAgICAgICAgIGBMYXN0IHBhcnRpdGlvbiBkYXRlICgke2xhc3RQYXJ0aXRpb259KSBkb2VzIG5vdCBtYXRjaCBlbmQgZGF0ZSAoJHtkYXRlUmFuZ2UudG99KWBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGpvYklkLFxuICAgICAgam9iTmFtZTogam9iLm5hbWUsXG4gICAgICBleHBlY3RlZERheXMsXG4gICAgICBhY3R1YWxQYXJ0aXRpb25zLFxuICAgICAgcGFydGl0aW9uRGF0ZXMsXG4gICAgICBleHBlY3RlZERhdGVSYW5nZTogZGF0ZVJhbmdlLFxuICAgICAgZGlzY3JlcGFuY3ksXG4gICAgICBpc3N1ZXMsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIHJldHVybiB7XG4gICAgICBqb2JJZCxcbiAgICAgIGpvYk5hbWU6ICdVbmtub3duJyxcbiAgICAgIGV4cGVjdGVkRGF5czogMCxcbiAgICAgIGFjdHVhbFBhcnRpdGlvbnM6IDAsXG4gICAgICBwYXJ0aXRpb25EYXRlczogW10sXG4gICAgICBleHBlY3RlZERhdGVSYW5nZTogeyBmcm9tOiAnJywgdG86ICcnIH0sXG4gICAgICBkaXNjcmVwYW5jeTogMCxcbiAgICAgIGlzc3VlczogW2BFcnJvciBhdWRpdGluZyBqb2I6ICR7ZXJyb3IubWVzc2FnZX1gXSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogQXVkaXQgYWxsIFBPSSBjb2xsZWN0aW9uc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaXRBbGxQT0lDb2xsZWN0aW9ucygpOiBQcm9taXNlPFBPSUF1ZGl0UmVzdWx0W10+IHtcbiAgY29uc3QgeyBnZXRDb25maWcgfSA9IGF3YWl0IGltcG9ydCgnLi9zMy1jb25maWcnKTtcbiAgY29uc3QgY29sbGVjdGlvbnMgPSBhd2FpdCBnZXRDb25maWc8UmVjb3JkPHN0cmluZywgYW55Pj4oJ3BvaS1jb2xsZWN0aW9ucycpIHx8IHt9O1xuICBjb25zdCBjb2xsZWN0aW9uSWRzID0gT2JqZWN0LmtleXMoY29sbGVjdGlvbnMpO1xuICBcbiAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgIGNvbGxlY3Rpb25JZHMubWFwKGlkID0+IGF1ZGl0UE9JQ29sbGVjdGlvbihpZCkpXG4gICk7XG4gIFxuICByZXR1cm4gcmVzdWx0cztcbn1cblxuLyoqXG4gKiBBdWRpdCBhbGwgam9ic1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYXVkaXRBbGxKb2JzKCk6IFByb21pc2U8Sm9iQXVkaXRSZXN1bHRbXT4ge1xuICBjb25zdCBqb2JzID0gYXdhaXQgZ2V0QWxsSm9icygpO1xuICBcbiAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKFxuICAgIGpvYnMubWFwKGpvYiA9PiBhdWRpdEpvYihqb2Iuam9iSWQpKVxuICApO1xuICBcbiAgcmV0dXJuIHJlc3VsdHM7XG59XG4iXSwibmFtZXMiOlsiZ2V0UE9JQ29sbGVjdGlvbiIsImdldEFsbEpvYnMiLCJMaXN0T2JqZWN0c1YyQ29tbWFuZCIsInMzQ2xpZW50IiwiQlVDS0VUIiwiYXVkaXRQT0lDb2xsZWN0aW9uIiwiY29sbGVjdGlvbklkIiwiaXNzdWVzIiwiZ2V0Q29uZmlnIiwiY29sbGVjdGlvbnMiLCJjb2xsZWN0aW9uIiwiY29sbGVjdGlvbk5hbWUiLCJleHBlY3RlZENvdW50IiwiYWN0dWFsQ291bnQiLCJ2YWxpZFBvaW50cyIsImludmFsaWRGZWF0dXJlcyIsImRpc2NyZXBhbmN5IiwicG9pQ291bnQiLCJnZW9qc29uIiwibmFtZSIsInRvdGFsRmVhdHVyZXMiLCJmZWF0dXJlcyIsImxlbmd0aCIsImZpbHRlciIsImYiLCJnZW9tZXRyeSIsInR5cGUiLCJBcnJheSIsImlzQXJyYXkiLCJjb29yZGluYXRlcyIsImlzTmFOIiwicHVzaCIsImVycm9yIiwibWVzc2FnZSIsImF1ZGl0Sm9iIiwiam9iSWQiLCJqb2JzIiwiam9iIiwiZmluZCIsImoiLCJqb2JOYW1lIiwiZXhwZWN0ZWREYXlzIiwiYWN0dWFsUGFydGl0aW9ucyIsInBhcnRpdGlvbkRhdGVzIiwiZXhwZWN0ZWREYXRlUmFuZ2UiLCJmcm9tIiwidG8iLCJkYXRlUmFuZ2UiLCJmcm9tRGF0ZSIsIkRhdGUiLCJ0b0RhdGUiLCJNYXRoIiwiY2VpbCIsImdldFRpbWUiLCJkYXRhc2V0TmFtZSIsInByZWZpeCIsInBhcnRpdGlvbnMiLCJTZXQiLCJjb250aW51YXRpb25Ub2tlbiIsImxpc3RSZXMiLCJzZW5kIiwiQnVja2V0IiwiUHJlZml4IiwiRGVsaW1pdGVyIiwiQ29tbW9uUHJlZml4ZXMiLCJwcmVmaXhPYmoiLCJwcmVmaXhQYXRoIiwibWF0Y2giLCJhZGQiLCJDb250ZW50cyIsIm9iaiIsImtleSIsIktleSIsIk5leHRDb250aW51YXRpb25Ub2tlbiIsInNvcnQiLCJmaXJzdFBhcnRpdGlvbiIsImxhc3RQYXJ0aXRpb24iLCJhdWRpdEFsbFBPSUNvbGxlY3Rpb25zIiwiY29sbGVjdGlvbklkcyIsIk9iamVjdCIsImtleXMiLCJyZXN1bHRzIiwiUHJvbWlzZSIsImFsbCIsIm1hcCIsImlkIiwiYXVkaXRBbGxKb2JzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/audit.ts\n");

/***/ }),

/***/ "(rsc)/./lib/jobs.ts":
/*!*********************!*\
  !*** ./lib/jobs.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createJob: () => (/* binding */ createJob),\n/* harmony export */   getAllJobs: () => (/* binding */ getAllJobs),\n/* harmony export */   getJob: () => (/* binding */ getJob),\n/* harmony export */   markJobSynced: () => (/* binding */ markJobSynced),\n/* harmony export */   updateJob: () => (/* binding */ updateJob),\n/* harmony export */   updateJobStatus: () => (/* binding */ updateJobStatus)\n/* harmony export */ });\n/* harmony import */ var _s3_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./s3-config */ \"(rsc)/./lib/s3-config.ts\");\n\nconst DEFAULT_JOBS = {};\n/**\n * Get all jobs sorted by creation date (newest first)\n */ async function getAllJobs() {\n    const data = await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.initConfigIfNeeded)(\"jobs\", DEFAULT_JOBS);\n    return Object.values(data).sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime());\n}\n/**\n * Get a specific job by ID\n */ async function getJob(jobId) {\n    const data = await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.initConfigIfNeeded)(\"jobs\", DEFAULT_JOBS);\n    return data[jobId] || null;\n}\n/**\n * Create a new job\n */ async function createJob(job) {\n    const data = await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.initConfigIfNeeded)(\"jobs\", DEFAULT_JOBS);\n    const newJob = {\n        ...job,\n        createdAt: new Date().toISOString(),\n        updatedAt: new Date().toISOString()\n    };\n    data[job.jobId] = newJob;\n    try {\n        await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.putConfig)(\"jobs\", data);\n        console.log(` Job created: ${job.jobId} - ${job.name}`);\n    } catch (error) {\n        console.error(` Failed to save job ${job.jobId}:`, error);\n        throw error;\n    }\n    return newJob;\n}\n/**\n * Update an existing job\n */ async function updateJob(jobId, updates) {\n    const data = await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.initConfigIfNeeded)(\"jobs\", DEFAULT_JOBS);\n    if (!data[jobId]) {\n        console.error(` Job not found: ${jobId}`);\n        return null;\n    }\n    data[jobId] = {\n        ...data[jobId],\n        ...updates,\n        updatedAt: new Date().toISOString()\n    };\n    try {\n        await (0,_s3_config__WEBPACK_IMPORTED_MODULE_0__.putConfig)(\"jobs\", data);\n        console.log(` Job updated: ${jobId}`);\n    } catch (error) {\n        console.error(` Failed to update job ${jobId}:`, error);\n        throw error;\n    }\n    return data[jobId];\n}\n/**\n * Update job status\n */ async function updateJobStatus(jobId, status, errorMessage) {\n    return updateJob(jobId, {\n        status,\n        errorMessage\n    });\n}\n/**\n * Mark job as synced with S3 details\n */ async function markJobSynced(jobId, s3DestPath, objectCount, totalBytes) {\n    return updateJob(jobId, {\n        s3DestPath,\n        objectCount,\n        totalBytes,\n        syncedAt: new Date().toISOString()\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvam9icy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXVFO0FBNEJ2RSxNQUFNRSxlQUF5QixDQUFDO0FBRWhDOztDQUVDLEdBQ00sZUFBZUM7SUFDcEIsTUFBTUMsT0FBTyxNQUFNSCw4REFBa0JBLENBQVcsUUFBUUM7SUFDeEQsT0FBT0csT0FBT0MsTUFBTSxDQUFDRixNQUFNRyxJQUFJLENBQUMsQ0FBQ0MsR0FBR0MsSUFDbEMsSUFBSUMsS0FBS0QsRUFBRUUsU0FBUyxFQUFFQyxPQUFPLEtBQUssSUFBSUYsS0FBS0YsRUFBRUcsU0FBUyxFQUFFQyxPQUFPO0FBRW5FO0FBRUE7O0NBRUMsR0FDTSxlQUFlQyxPQUFPQyxLQUFhO0lBQ3hDLE1BQU1WLE9BQU8sTUFBTUgsOERBQWtCQSxDQUFXLFFBQVFDO0lBQ3hELE9BQU9FLElBQUksQ0FBQ1UsTUFBTSxJQUFJO0FBQ3hCO0FBRUE7O0NBRUMsR0FDTSxlQUFlQyxVQUFVQyxHQUF5QztJQUN2RSxNQUFNWixPQUFPLE1BQU1ILDhEQUFrQkEsQ0FBVyxRQUFRQztJQUV4RCxNQUFNZSxTQUFjO1FBQ2xCLEdBQUdELEdBQUc7UUFDTkwsV0FBVyxJQUFJRCxPQUFPUSxXQUFXO1FBQ2pDQyxXQUFXLElBQUlULE9BQU9RLFdBQVc7SUFDbkM7SUFFQWQsSUFBSSxDQUFDWSxJQUFJRixLQUFLLENBQUMsR0FBR0c7SUFFbEIsSUFBSTtRQUNGLE1BQU1qQixxREFBU0EsQ0FBQyxRQUFRSTtRQUN4QmdCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsRUFBRUwsSUFBSUYsS0FBSyxDQUFDLEdBQUcsRUFBRUUsSUFBSU0sSUFBSSxDQUFDLENBQUM7SUFDekQsRUFBRSxPQUFPQyxPQUFPO1FBQ2RILFFBQVFHLEtBQUssQ0FBQyxDQUFDLHFCQUFxQixFQUFFUCxJQUFJRixLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUVTO1FBQ3BELE1BQU1BO0lBQ1I7SUFFQSxPQUFPTjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxlQUFlTyxVQUFVVixLQUFhLEVBQUVXLE9BQXFCO0lBQ2xFLE1BQU1yQixPQUFPLE1BQU1ILDhEQUFrQkEsQ0FBVyxRQUFRQztJQUV4RCxJQUFJLENBQUNFLElBQUksQ0FBQ1UsTUFBTSxFQUFFO1FBQ2hCTSxRQUFRRyxLQUFLLENBQUMsQ0FBQyxpQkFBaUIsRUFBRVQsTUFBTSxDQUFDO1FBQ3pDLE9BQU87SUFDVDtJQUVBVixJQUFJLENBQUNVLE1BQU0sR0FBRztRQUNaLEdBQUdWLElBQUksQ0FBQ1UsTUFBTTtRQUNkLEdBQUdXLE9BQU87UUFDVk4sV0FBVyxJQUFJVCxPQUFPUSxXQUFXO0lBQ25DO0lBRUEsSUFBSTtRQUNGLE1BQU1sQixxREFBU0EsQ0FBQyxRQUFRSTtRQUN4QmdCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGVBQWUsRUFBRVAsTUFBTSxDQUFDO0lBQ3ZDLEVBQUUsT0FBT1MsT0FBTztRQUNkSCxRQUFRRyxLQUFLLENBQUMsQ0FBQyx1QkFBdUIsRUFBRVQsTUFBTSxDQUFDLENBQUMsRUFBRVM7UUFDbEQsTUFBTUE7SUFDUjtJQUVBLE9BQU9uQixJQUFJLENBQUNVLE1BQU07QUFDcEI7QUFFQTs7Q0FFQyxHQUNNLGVBQWVZLGdCQUNwQlosS0FBYSxFQUNiYSxNQUFxQixFQUNyQkMsWUFBcUI7SUFFckIsT0FBT0osVUFBVVYsT0FBTztRQUFFYTtRQUFRQztJQUFhO0FBQ2pEO0FBRUE7O0NBRUMsR0FDTSxlQUFlQyxjQUNwQmYsS0FBYSxFQUNiZ0IsVUFBa0IsRUFDbEJDLFdBQW1CLEVBQ25CQyxVQUFrQjtJQUVsQixPQUFPUixVQUFVVixPQUFPO1FBQ3RCZ0I7UUFDQUM7UUFDQUM7UUFDQUMsVUFBVSxJQUFJdkIsT0FBT1EsV0FBVztJQUNsQztBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLy4vbGliL2pvYnMudHM/NzhiYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRDb25maWcsIHB1dENvbmZpZywgaW5pdENvbmZpZ0lmTmVlZGVkIH0gZnJvbSAnLi9zMy1jb25maWcnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEpvYiB7XG4gIGpvYklkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgdHlwZTogJ3BpbmdzJyB8ICdhZ2dyZWdhdGUnIHwgJ2RldmljZXMnIHwgJ2NvaG9ydCc7XG4gIHBvaUNvdW50OiBudW1iZXI7XG4gIHBvaUNvbGxlY3Rpb25JZD86IHN0cmluZztcbiAgZGF0ZVJhbmdlOiB7IGZyb206IHN0cmluZzsgdG86IHN0cmluZyB9O1xuICByYWRpdXM6IG51bWJlcjtcbiAgc2NoZW1hOiAnQkFTSUMnIHwgJ0ZVTEwnIHwgJ0VOSEFOQ0VEJyB8ICdOL0EnO1xuICBzdGF0dXM6ICdRVUVVRUQnIHwgJ1JVTk5JTkcnIHwgJ1NVQ0NFU1MnIHwgJ0ZBSUxFRCcgfCAnU0NIRURVTEVEJztcbiAgczNTb3VyY2VQYXRoPzogc3RyaW5nO1xuICBzM0Rlc3RQYXRoPzogc3RyaW5nIHwgbnVsbDtcbiAgb2JqZWN0Q291bnQ/OiBudW1iZXI7XG4gIHRvdGFsQnl0ZXM/OiBudW1iZXI7XG4gIHN5bmNlZEF0Pzogc3RyaW5nIHwgbnVsbDtcbiAgZXJyb3JNZXNzYWdlPzogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IHN0cmluZztcbiAgdXBkYXRlZEF0Pzogc3RyaW5nO1xuICBzdW1tYXJ5TWV0cmljcz86IHN0cmluZztcbiAgZXh0ZXJuYWw/OiBib29sZWFuOyAvLyB0cnVlID0gY3JlYXRlZCBvdXRzaWRlIGFwcCwgZG9lc24ndCBjb3VudCB0b3dhcmQgcXVvdGFcbiAgcG9pTWFwcGluZz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz47IC8vIE1hcHMgVmVyYXNldCBQT0kgSURzIChnZW9fcmFkaXVzX1gpIHRvIG9yaWdpbmFsIEdlb0pTT04gSURzXG4gIHBvaU5hbWVzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nPjsgLy8gTWFwcyBWZXJhc2V0IFBPSSBJRHMgKGdlb19yYWRpdXNfWCkgdG8gaHVtYW4tcmVhZGFibGUgbmFtZXMgZnJvbSBHZW9KU09OIHByb3BlcnRpZXMubmFtZVxufVxuXG50eXBlIEpvYnNEYXRhID0gUmVjb3JkPHN0cmluZywgSm9iPjtcblxuY29uc3QgREVGQVVMVF9KT0JTOiBKb2JzRGF0YSA9IHt9O1xuXG4vKipcbiAqIEdldCBhbGwgam9icyBzb3J0ZWQgYnkgY3JlYXRpb24gZGF0ZSAobmV3ZXN0IGZpcnN0KVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsSm9icygpOiBQcm9taXNlPEpvYltdPiB7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBpbml0Q29uZmlnSWZOZWVkZWQ8Sm9ic0RhdGE+KCdqb2JzJywgREVGQVVMVF9KT0JTKTtcbiAgcmV0dXJuIE9iamVjdC52YWx1ZXMoZGF0YSkuc29ydCgoYSwgYikgPT4gXG4gICAgbmV3IERhdGUoYi5jcmVhdGVkQXQpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEuY3JlYXRlZEF0KS5nZXRUaW1lKClcbiAgKTtcbn1cblxuLyoqXG4gKiBHZXQgYSBzcGVjaWZpYyBqb2IgYnkgSURcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEpvYihqb2JJZDogc3RyaW5nKTogUHJvbWlzZTxKb2IgfCBudWxsPiB7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBpbml0Q29uZmlnSWZOZWVkZWQ8Sm9ic0RhdGE+KCdqb2JzJywgREVGQVVMVF9KT0JTKTtcbiAgcmV0dXJuIGRhdGFbam9iSWRdIHx8IG51bGw7XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGpvYlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlSm9iKGpvYjogT21pdDxKb2IsICdjcmVhdGVkQXQnIHwgJ3VwZGF0ZWRBdCc+KTogUHJvbWlzZTxKb2I+IHtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IGluaXRDb25maWdJZk5lZWRlZDxKb2JzRGF0YT4oJ2pvYnMnLCBERUZBVUxUX0pPQlMpO1xuICBcbiAgY29uc3QgbmV3Sm9iOiBKb2IgPSB7XG4gICAgLi4uam9iLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICB9O1xuICBcbiAgZGF0YVtqb2Iuam9iSWRdID0gbmV3Sm9iO1xuICBcbiAgdHJ5IHtcbiAgICBhd2FpdCBwdXRDb25maWcoJ2pvYnMnLCBkYXRhKTtcbiAgICBjb25zb2xlLmxvZyhg4pyFIEpvYiBjcmVhdGVkOiAke2pvYi5qb2JJZH0gLSAke2pvYi5uYW1lfWApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBGYWlsZWQgdG8gc2F2ZSBqb2IgJHtqb2Iuam9iSWR9OmAsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBcbiAgcmV0dXJuIG5ld0pvYjtcbn1cblxuLyoqXG4gKiBVcGRhdGUgYW4gZXhpc3Rpbmcgam9iXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVKb2Ioam9iSWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxKb2I+KTogUHJvbWlzZTxKb2IgfCBudWxsPiB7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBpbml0Q29uZmlnSWZOZWVkZWQ8Sm9ic0RhdGE+KCdqb2JzJywgREVGQVVMVF9KT0JTKTtcbiAgXG4gIGlmICghZGF0YVtqb2JJZF0pIHtcbiAgICBjb25zb2xlLmVycm9yKGDinYwgSm9iIG5vdCBmb3VuZDogJHtqb2JJZH1gKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBcbiAgZGF0YVtqb2JJZF0gPSB7XG4gICAgLi4uZGF0YVtqb2JJZF0sXG4gICAgLi4udXBkYXRlcyxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgfTtcbiAgXG4gIHRyeSB7XG4gICAgYXdhaXQgcHV0Q29uZmlnKCdqb2JzJywgZGF0YSk7XG4gICAgY29uc29sZS5sb2coYOKchSBKb2IgdXBkYXRlZDogJHtqb2JJZH1gKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGDinYwgRmFpbGVkIHRvIHVwZGF0ZSBqb2IgJHtqb2JJZH06YCwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG4gIFxuICByZXR1cm4gZGF0YVtqb2JJZF07XG59XG5cbi8qKlxuICogVXBkYXRlIGpvYiBzdGF0dXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUpvYlN0YXR1cyhcbiAgam9iSWQ6IHN0cmluZyxcbiAgc3RhdHVzOiBKb2JbJ3N0YXR1cyddLFxuICBlcnJvck1lc3NhZ2U/OiBzdHJpbmdcbik6IFByb21pc2U8Sm9iIHwgbnVsbD4ge1xuICByZXR1cm4gdXBkYXRlSm9iKGpvYklkLCB7IHN0YXR1cywgZXJyb3JNZXNzYWdlIH0pO1xufVxuXG4vKipcbiAqIE1hcmsgam9iIGFzIHN5bmNlZCB3aXRoIFMzIGRldGFpbHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG1hcmtKb2JTeW5jZWQoXG4gIGpvYklkOiBzdHJpbmcsXG4gIHMzRGVzdFBhdGg6IHN0cmluZyxcbiAgb2JqZWN0Q291bnQ6IG51bWJlcixcbiAgdG90YWxCeXRlczogbnVtYmVyXG4pOiBQcm9taXNlPEpvYiB8IG51bGw+IHtcbiAgcmV0dXJuIHVwZGF0ZUpvYihqb2JJZCwge1xuICAgIHMzRGVzdFBhdGgsXG4gICAgb2JqZWN0Q291bnQsXG4gICAgdG90YWxCeXRlcyxcbiAgICBzeW5jZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJwdXRDb25maWciLCJpbml0Q29uZmlnSWZOZWVkZWQiLCJERUZBVUxUX0pPQlMiLCJnZXRBbGxKb2JzIiwiZGF0YSIsIk9iamVjdCIsInZhbHVlcyIsInNvcnQiLCJhIiwiYiIsIkRhdGUiLCJjcmVhdGVkQXQiLCJnZXRUaW1lIiwiZ2V0Sm9iIiwiam9iSWQiLCJjcmVhdGVKb2IiLCJqb2IiLCJuZXdKb2IiLCJ0b0lTT1N0cmluZyIsInVwZGF0ZWRBdCIsImNvbnNvbGUiLCJsb2ciLCJuYW1lIiwiZXJyb3IiLCJ1cGRhdGVKb2IiLCJ1cGRhdGVzIiwidXBkYXRlSm9iU3RhdHVzIiwic3RhdHVzIiwiZXJyb3JNZXNzYWdlIiwibWFya0pvYlN5bmNlZCIsInMzRGVzdFBhdGgiLCJvYmplY3RDb3VudCIsInRvdGFsQnl0ZXMiLCJzeW5jZWRBdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/jobs.ts\n");

/***/ }),

/***/ "(rsc)/./lib/s3-config.ts":
/*!**************************!*\
  !*** ./lib/s3-config.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BUCKET: () => (/* binding */ BUCKET),\n/* harmony export */   configExists: () => (/* binding */ configExists),\n/* harmony export */   getConfig: () => (/* binding */ getConfig),\n/* harmony export */   getPOICollection: () => (/* binding */ getPOICollection),\n/* harmony export */   initConfigIfNeeded: () => (/* binding */ initConfigIfNeeded),\n/* harmony export */   listObjects: () => (/* binding */ listObjects),\n/* harmony export */   putConfig: () => (/* binding */ putConfig),\n/* harmony export */   putPOICollection: () => (/* binding */ putPOICollection),\n/* harmony export */   s3Client: () => (/* binding */ s3Client),\n/* harmony export */   updateConfig: () => (/* binding */ updateConfig)\n/* harmony export */ });\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\");\n/* harmony import */ var _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst s3Client = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.S3Client({\n    region: process.env.AWS_REGION || \"us-west-2\",\n    credentials: {\n        accessKeyId: process.env.AWS_ACCESS_KEY_ID || \"\",\n        secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY || \"\"\n    }\n});\nconst BUCKET = process.env.S3_BUCKET || \"garritz-veraset-data-us-west-2\";\n/**\n * Check if config file exists in S3\n */ async function configExists(key) {\n    try {\n        if (!process.env.AWS_ACCESS_KEY_ID || !process.env.AWS_SECRET_ACCESS_KEY) {\n            return false;\n        }\n        await s3Client.send(new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.HeadObjectCommand({\n            Bucket: BUCKET,\n            Key: `config/${key}.json`\n        }));\n        return true;\n    } catch (error) {\n        if (error.name === \"NoSuchKey\" || error.$metadata?.httpStatusCode === 404) {\n            return false;\n        }\n        // Other errors (permissions, network) - assume doesn't exist\n        return false;\n    }\n}\n/**\n * Read a JSON config file from S3 with proper error handling\n */ async function getConfig(key) {\n    try {\n        // Check if AWS credentials are configured\n        if (!process.env.AWS_ACCESS_KEY_ID || !process.env.AWS_SECRET_ACCESS_KEY) {\n            console.warn(`AWS credentials not configured. Returning null for config/${key}.json`);\n            return null;\n        }\n        const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n            Bucket: BUCKET,\n            Key: `config/${key}.json`\n        });\n        const response = await s3Client.send(command);\n        const body = await response.Body?.transformToString();\n        if (!body) {\n            return null;\n        }\n        return JSON.parse(body);\n    } catch (error) {\n        // File doesn't exist\n        if (error.name === \"NoSuchKey\" || error.$metadata?.httpStatusCode === 404) {\n            console.warn(`Config file not found: config/${key}.json`);\n            return null;\n        }\n        // Don't throw errors in development - just log and return null\n        if (true) {\n            console.warn(`Error reading config/${key}.json:`, error.message || error);\n            return null;\n        }\n        console.error(`Error reading config/${key}.json:`, error);\n        throw error;\n    }\n}\n/**\n * Write a JSON config file to S3 with validation\n */ async function putConfig(key, data) {\n    try {\n        if (!process.env.AWS_ACCESS_KEY_ID || !process.env.AWS_SECRET_ACCESS_KEY) {\n            throw new Error(\"AWS credentials not configured\");\n        }\n        const json = JSON.stringify(data, null, 2);\n        // Validate JSON before saving\n        JSON.parse(json);\n        const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n            Bucket: BUCKET,\n            Key: `config/${key}.json`,\n            Body: json,\n            ContentType: \"application/json\"\n        });\n        await s3Client.send(command);\n        console.log(` Saved config/${key}.json`);\n    } catch (error) {\n        console.error(` Error saving config/${key}.json:`, error.message || error);\n        throw error;\n    }\n}\n/**\n * Initialize config file if it doesn't exist\n */ async function initConfigIfNeeded(key, defaultData) {\n    const exists = await configExists(key);\n    if (!exists) {\n        console.log(` Initializing config/${key}.json with defaults`);\n        try {\n            await putConfig(key, defaultData);\n            return defaultData;\n        } catch (error) {\n            console.warn(`Could not initialize config/${key}.json, using in-memory default`);\n            return defaultData;\n        }\n    }\n    const existing = await getConfig(key);\n    return existing || defaultData;\n}\n/**\n * Update a JSON config file (read, modify, write)\n */ async function updateConfig(key, updater) {\n    const existing = await getConfig(key);\n    const updated = updater(existing);\n    await putConfig(key, updated);\n    return updated;\n}\n/**\n * List all objects in a prefix\n */ async function listObjects(prefix) {\n    try {\n        if (!process.env.AWS_ACCESS_KEY_ID || !process.env.AWS_SECRET_ACCESS_KEY) {\n            return [];\n        }\n        const { ListObjectsV2Command } = await Promise.resolve(/*! import() */).then(__webpack_require__.t.bind(__webpack_require__, /*! @aws-sdk/client-s3 */ \"@aws-sdk/client-s3\", 23));\n        const command = new ListObjectsV2Command({\n            Bucket: BUCKET,\n            Prefix: prefix\n        });\n        const response = await s3Client.send(command);\n        return (response.Contents || []).map((obj)=>obj.Key || \"\").filter(Boolean);\n    } catch (error) {\n        console.warn(`Error listing objects with prefix ${prefix}:`, error);\n        return [];\n    }\n}\n/**\n * Get POI collection GeoJSON from S3, with fallback to local files\n */ async function getPOICollection(collectionId) {\n    try {\n        // Get collection metadata to find the correct GeoJSON path\n        const collections = await getConfig(\"poi-collections\") || {};\n        const collection = collections[collectionId];\n        // Use geojsonPath from collection metadata if available, otherwise construct from ID\n        const geojsonKey = collection?.geojsonPath || `pois/${collectionId}.geojson`;\n        // Try S3 first if credentials are configured and collection exists in config\n        if (collection && process.env.AWS_ACCESS_KEY_ID && process.env.AWS_SECRET_ACCESS_KEY) {\n            try {\n                const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.GetObjectCommand({\n                    Bucket: BUCKET,\n                    Key: geojsonKey\n                });\n                const response = await s3Client.send(command);\n                const body = await response.Body?.transformToString();\n                if (body) {\n                    return JSON.parse(body);\n                }\n            } catch (s3Error) {\n                if (s3Error.name !== \"NoSuchKey\" && s3Error.$metadata?.httpStatusCode !== 404) {\n                    console.warn(`S3 error for ${geojsonKey}, trying local fallback:`, s3Error.message);\n                }\n            // Fall through to local file check\n            }\n        }\n        // Fallback: Try to read from local POIs directory\n        // Map collection IDs to local file names (with underscores)\n        const localFileMap = {\n            \"spain-ecigarette-combined\": \"spain_ecigarette_combined.geojson\",\n            \"spain-tobacco-combined\": \"spain_tobacco_combined.geojson\",\n            \"spain-nicotine-full\": \"overture_spain_nicotine_clean.geojson\"\n        };\n        const localFileName = localFileMap[collectionId] || `${collectionId.replace(/-/g, \"_\")}.geojson`;\n        const localPath = path__WEBPACK_IMPORTED_MODULE_2__.join(process.cwd(), \"POIs\", localFileName);\n        if (fs__WEBPACK_IMPORTED_MODULE_1__.existsSync(localPath)) {\n            console.log(` Using local GeoJSON file: ${localPath}`);\n            const fileContent = fs__WEBPACK_IMPORTED_MODULE_1__.readFileSync(localPath, \"utf-8\");\n            return JSON.parse(fileContent);\n        }\n        if (!collection) {\n            console.warn(`POI collection ${collectionId} not found in config and no local file found`);\n        } else {\n            console.warn(`GeoJSON file not found in S3 or locally for collection ${collectionId}`);\n        }\n        return null;\n    } catch (error) {\n        console.error(`Error reading GeoJSON for collection ${collectionId}:`, error);\n        throw error;\n    }\n}\n/**\n * Save POI collection GeoJSON to S3\n */ async function putPOICollection(collectionId, geojson) {\n    if (!process.env.AWS_ACCESS_KEY_ID || !process.env.AWS_SECRET_ACCESS_KEY) {\n        throw new Error(\"AWS credentials not configured\");\n    }\n    const command = new _aws_sdk_client_s3__WEBPACK_IMPORTED_MODULE_0__.PutObjectCommand({\n        Bucket: BUCKET,\n        Key: `pois/${collectionId}.geojson`,\n        Body: JSON.stringify(geojson, null, 2),\n        ContentType: \"application/json\"\n    });\n    await s3Client.send(command);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQyxFQUFFdkM7UUFDdkUsTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlc0QsaUJBQWlCZixZQUFvQixFQUFFZ0IsT0FBWTtJQUN2RSxJQUFJLENBQUN0RSxRQUFRQyxHQUFHLENBQUNJLGlCQUFpQixJQUFJLENBQUNMLFFBQVFDLEdBQUcsQ0FBQ00scUJBQXFCLEVBQUU7UUFDeEUsTUFBTSxJQUFJeUIsTUFBTTtJQUNsQjtJQUVBLE1BQU1WLFVBQVUsSUFBSTVCLGdFQUFnQkEsQ0FBQztRQUNuQ21CLFFBQVFMO1FBQ1JNLEtBQUssQ0FBQyxLQUFLLEVBQUV3QyxhQUFhLFFBQVEsQ0FBQztRQUNuQzdCLE1BQU1FLEtBQUtPLFNBQVMsQ0FBQ29DLFNBQVMsTUFBTTtRQUNwQ25DLGFBQWE7SUFDZjtJQUVBLE1BQU1yQyxTQUFTYyxJQUFJLENBQUNVO0FBQ3RCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLy4vbGliL3MzLWNvbmZpZy50cz9mYTFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFMzQ2xpZW50LCBHZXRPYmplY3RDb21tYW5kLCBQdXRPYmplY3RDb21tYW5kLCBIZWFkT2JqZWN0Q29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1zMyc7XG5pbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG5leHBvcnQgY29uc3QgczNDbGllbnQgPSBuZXcgUzNDbGllbnQoe1xuICByZWdpb246IHByb2Nlc3MuZW52LkFXU19SRUdJT04gfHwgJ3VzLXdlc3QtMicsXG4gIGNyZWRlbnRpYWxzOiB7XG4gICAgYWNjZXNzS2V5SWQ6IHByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lEIHx8ICcnLFxuICAgIHNlY3JldEFjY2Vzc0tleTogcHJvY2Vzcy5lbnYuQVdTX1NFQ1JFVF9BQ0NFU1NfS0VZIHx8ICcnLFxuICB9LFxufSk7XG5cbmV4cG9ydCBjb25zdCBCVUNLRVQgPSBwcm9jZXNzLmVudi5TM19CVUNLRVQgfHwgJ2dhcnJpdHotdmVyYXNldC1kYXRhLXVzLXdlc3QtMic7XG5cbi8qKlxuICogQ2hlY2sgaWYgY29uZmlnIGZpbGUgZXhpc3RzIGluIFMzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25maWdFeGlzdHMoa2V5OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIXByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lEIHx8ICFwcm9jZXNzLmVudi5BV1NfU0VDUkVUX0FDQ0VTU19LRVkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgYXdhaXQgczNDbGllbnQuc2VuZChuZXcgSGVhZE9iamVjdENvbW1hbmQoe1xuICAgICAgQnVja2V0OiBCVUNLRVQsXG4gICAgICBLZXk6IGBjb25maWcvJHtrZXl9Lmpzb25gLFxuICAgIH0pKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGlmIChlcnJvci5uYW1lID09PSAnTm9TdWNoS2V5JyB8fCBlcnJvci4kbWV0YWRhdGE/Lmh0dHBTdGF0dXNDb2RlID09PSA0MDQpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgLy8gT3RoZXIgZXJyb3JzIChwZXJtaXNzaW9ucywgbmV0d29yaykgLSBhc3N1bWUgZG9lc24ndCBleGlzdFxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIFJlYWQgYSBKU09OIGNvbmZpZyBmaWxlIGZyb20gUzMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENvbmZpZzxUPihrZXk6IHN0cmluZyk6IFByb21pc2U8VCB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICAvLyBDaGVjayBpZiBBV1MgY3JlZGVudGlhbHMgYXJlIGNvbmZpZ3VyZWRcbiAgICBpZiAoIXByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lEIHx8ICFwcm9jZXNzLmVudi5BV1NfU0VDUkVUX0FDQ0VTU19LRVkpIHtcbiAgICAgIGNvbnNvbGUud2FybihgQVdTIGNyZWRlbnRpYWxzIG5vdCBjb25maWd1cmVkLiBSZXR1cm5pbmcgbnVsbCBmb3IgY29uZmlnLyR7a2V5fS5qc29uYCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBjb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xuICAgICAgQnVja2V0OiBCVUNLRVQsXG4gICAgICBLZXk6IGBjb25maWcvJHtrZXl9Lmpzb25gLFxuICAgIH0pO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgczNDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzcG9uc2UuQm9keT8udHJhbnNmb3JtVG9TdHJpbmcoKTtcbiAgICBcbiAgICBpZiAoIWJvZHkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gSlNPTi5wYXJzZShib2R5KSBhcyBUO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgLy8gRmlsZSBkb2Vzbid0IGV4aXN0XG4gICAgaWYgKGVycm9yLm5hbWUgPT09ICdOb1N1Y2hLZXknIHx8IGVycm9yLiRtZXRhZGF0YT8uaHR0cFN0YXR1c0NvZGUgPT09IDQwNCkge1xuICAgICAgY29uc29sZS53YXJuKGBDb25maWcgZmlsZSBub3QgZm91bmQ6IGNvbmZpZy8ke2tleX0uanNvbmApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIFxuICAgIC8vIERvbid0IHRocm93IGVycm9ycyBpbiBkZXZlbG9wbWVudCAtIGp1c3QgbG9nIGFuZCByZXR1cm4gbnVsbFxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgY29uc29sZS53YXJuKGBFcnJvciByZWFkaW5nIGNvbmZpZy8ke2tleX0uanNvbjpgLCBlcnJvci5tZXNzYWdlIHx8IGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciByZWFkaW5nIGNvbmZpZy8ke2tleX0uanNvbjpgLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiBXcml0ZSBhIEpTT04gY29uZmlnIGZpbGUgdG8gUzMgd2l0aCB2YWxpZGF0aW9uXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwdXRDb25maWc8VD4oa2V5OiBzdHJpbmcsIGRhdGE6IFQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICBpZiAoIXByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lEIHx8ICFwcm9jZXNzLmVudi5BV1NfU0VDUkVUX0FDQ0VTU19LRVkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQVdTIGNyZWRlbnRpYWxzIG5vdCBjb25maWd1cmVkJyk7XG4gICAgfVxuXG4gICAgY29uc3QganNvbiA9IEpTT04uc3RyaW5naWZ5KGRhdGEsIG51bGwsIDIpO1xuICAgIFxuICAgIC8vIFZhbGlkYXRlIEpTT04gYmVmb3JlIHNhdmluZ1xuICAgIEpTT04ucGFyc2UoanNvbik7XG4gICAgXG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBQdXRPYmplY3RDb21tYW5kKHtcbiAgICAgIEJ1Y2tldDogQlVDS0VULFxuICAgICAgS2V5OiBgY29uZmlnLyR7a2V5fS5qc29uYCxcbiAgICAgIEJvZHk6IGpzb24sXG4gICAgICBDb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgIH0pO1xuICAgIFxuICAgIGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZCk7XG4gICAgY29uc29sZS5sb2coYOKchSBTYXZlZCBjb25maWcvJHtrZXl9Lmpzb25gKTtcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnNvbGUuZXJyb3IoYOKdjCBFcnJvciBzYXZpbmcgY29uZmlnLyR7a2V5fS5qc29uOmAsIGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBjb25maWcgZmlsZSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0Q29uZmlnSWZOZWVkZWQ8VD4oa2V5OiBzdHJpbmcsIGRlZmF1bHREYXRhOiBUKTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IGV4aXN0cyA9IGF3YWl0IGNvbmZpZ0V4aXN0cyhrZXkpO1xuICBcbiAgaWYgKCFleGlzdHMpIHtcbiAgICBjb25zb2xlLmxvZyhg8J+TnSBJbml0aWFsaXppbmcgY29uZmlnLyR7a2V5fS5qc29uIHdpdGggZGVmYXVsdHNgKTtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgcHV0Q29uZmlnKGtleSwgZGVmYXVsdERhdGEpO1xuICAgICAgcmV0dXJuIGRlZmF1bHREYXRhO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oYENvdWxkIG5vdCBpbml0aWFsaXplIGNvbmZpZy8ke2tleX0uanNvbiwgdXNpbmcgaW4tbWVtb3J5IGRlZmF1bHRgKTtcbiAgICAgIHJldHVybiBkZWZhdWx0RGF0YTtcbiAgICB9XG4gIH1cbiAgXG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgZ2V0Q29uZmlnPFQ+KGtleSk7XG4gIHJldHVybiBleGlzdGluZyB8fCBkZWZhdWx0RGF0YTtcbn1cblxuLyoqXG4gKiBVcGRhdGUgYSBKU09OIGNvbmZpZyBmaWxlIChyZWFkLCBtb2RpZnksIHdyaXRlKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlQ29uZmlnPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBhbnk+PihcbiAga2V5OiBzdHJpbmcsXG4gIHVwZGF0ZXI6IChkYXRhOiBUIHwgbnVsbCkgPT4gVFxuKTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgZ2V0Q29uZmlnPFQ+KGtleSk7XG4gIGNvbnN0IHVwZGF0ZWQgPSB1cGRhdGVyKGV4aXN0aW5nKTtcbiAgYXdhaXQgcHV0Q29uZmlnKGtleSwgdXBkYXRlZCk7XG4gIHJldHVybiB1cGRhdGVkO1xufVxuXG4vKipcbiAqIExpc3QgYWxsIG9iamVjdHMgaW4gYSBwcmVmaXhcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3RPYmplY3RzKHByZWZpeDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICB0cnkge1xuICAgIGlmICghcHJvY2Vzcy5lbnYuQVdTX0FDQ0VTU19LRVlfSUQgfHwgIXByb2Nlc3MuZW52LkFXU19TRUNSRVRfQUNDRVNTX0tFWSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cblxuICAgIGNvbnN0IHsgTGlzdE9iamVjdHNWMkNvbW1hbmQgfSA9IGF3YWl0IGltcG9ydCgnQGF3cy1zZGsvY2xpZW50LXMzJyk7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBMaXN0T2JqZWN0c1YyQ29tbWFuZCh7XG4gICAgICBCdWNrZXQ6IEJVQ0tFVCxcbiAgICAgIFByZWZpeDogcHJlZml4LFxuICAgIH0pO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgczNDbGllbnQuc2VuZChjb21tYW5kKTtcbiAgICByZXR1cm4gKHJlc3BvbnNlLkNvbnRlbnRzIHx8IFtdKS5tYXAob2JqID0+IG9iai5LZXkgfHwgJycpLmZpbHRlcihCb29sZWFuKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLndhcm4oYEVycm9yIGxpc3Rpbmcgb2JqZWN0cyB3aXRoIHByZWZpeCAke3ByZWZpeH06YCwgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBQT0kgY29sbGVjdGlvbiBHZW9KU09OIGZyb20gUzMsIHdpdGggZmFsbGJhY2sgdG8gbG9jYWwgZmlsZXNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBPSUNvbGxlY3Rpb24oY29sbGVjdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPGFueSB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICAvLyBHZXQgY29sbGVjdGlvbiBtZXRhZGF0YSB0byBmaW5kIHRoZSBjb3JyZWN0IEdlb0pTT04gcGF0aFxuICAgIGNvbnN0IGNvbGxlY3Rpb25zID0gYXdhaXQgZ2V0Q29uZmlnPFJlY29yZDxzdHJpbmcsIGFueT4+KCdwb2ktY29sbGVjdGlvbnMnKSB8fCB7fTtcbiAgICBjb25zdCBjb2xsZWN0aW9uID0gY29sbGVjdGlvbnNbY29sbGVjdGlvbklkXTtcbiAgICBcbiAgICAvLyBVc2UgZ2VvanNvblBhdGggZnJvbSBjb2xsZWN0aW9uIG1ldGFkYXRhIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGNvbnN0cnVjdCBmcm9tIElEXG4gICAgY29uc3QgZ2VvanNvbktleSA9IGNvbGxlY3Rpb24/Lmdlb2pzb25QYXRoIHx8IGBwb2lzLyR7Y29sbGVjdGlvbklkfS5nZW9qc29uYDtcblxuICAgIC8vIFRyeSBTMyBmaXJzdCBpZiBjcmVkZW50aWFscyBhcmUgY29uZmlndXJlZCBhbmQgY29sbGVjdGlvbiBleGlzdHMgaW4gY29uZmlnXG4gICAgaWYgKGNvbGxlY3Rpb24gJiYgcHJvY2Vzcy5lbnYuQVdTX0FDQ0VTU19LRVlfSUQgJiYgcHJvY2Vzcy5lbnYuQVdTX1NFQ1JFVF9BQ0NFU1NfS0VZKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBjb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xuICAgICAgICAgIEJ1Y2tldDogQlVDS0VULFxuICAgICAgICAgIEtleTogZ2VvanNvbktleSxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZCk7XG4gICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXNwb25zZS5Cb2R5Py50cmFuc2Zvcm1Ub1N0cmluZygpO1xuICAgICAgICBcbiAgICAgICAgaWYgKGJvZHkpIHtcbiAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShib2R5KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoczNFcnJvcjogYW55KSB7XG4gICAgICAgIGlmIChzM0Vycm9yLm5hbWUgIT09ICdOb1N1Y2hLZXknICYmIHMzRXJyb3IuJG1ldGFkYXRhPy5odHRwU3RhdHVzQ29kZSAhPT0gNDA0KSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBTMyBlcnJvciBmb3IgJHtnZW9qc29uS2V5fSwgdHJ5aW5nIGxvY2FsIGZhbGxiYWNrOmAsIHMzRXJyb3IubWVzc2FnZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRmFsbCB0aHJvdWdoIHRvIGxvY2FsIGZpbGUgY2hlY2tcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGYWxsYmFjazogVHJ5IHRvIHJlYWQgZnJvbSBsb2NhbCBQT0lzIGRpcmVjdG9yeVxuICAgIC8vIE1hcCBjb2xsZWN0aW9uIElEcyB0byBsb2NhbCBmaWxlIG5hbWVzICh3aXRoIHVuZGVyc2NvcmVzKVxuICAgIGNvbnN0IGxvY2FsRmlsZU1hcDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHtcbiAgICAgICdzcGFpbi1lY2lnYXJldHRlLWNvbWJpbmVkJzogJ3NwYWluX2VjaWdhcmV0dGVfY29tYmluZWQuZ2VvanNvbicsXG4gICAgICAnc3BhaW4tdG9iYWNjby1jb21iaW5lZCc6ICdzcGFpbl90b2JhY2NvX2NvbWJpbmVkLmdlb2pzb24nLFxuICAgICAgJ3NwYWluLW5pY290aW5lLWZ1bGwnOiAnb3ZlcnR1cmVfc3BhaW5fbmljb3RpbmVfY2xlYW4uZ2VvanNvbicsIC8vIFVzZSB0aGUgY29tYmluZWQgbmljb3RpbmUgZmlsZVxuICAgIH07XG5cbiAgICBjb25zdCBsb2NhbEZpbGVOYW1lID0gbG9jYWxGaWxlTWFwW2NvbGxlY3Rpb25JZF0gfHwgYCR7Y29sbGVjdGlvbklkLnJlcGxhY2UoLy0vZywgJ18nKX0uZ2VvanNvbmA7XG4gICAgY29uc3QgbG9jYWxQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksICdQT0lzJywgbG9jYWxGaWxlTmFtZSk7XG5cbiAgICBpZiAoZnMuZXhpc3RzU3luYyhsb2NhbFBhdGgpKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+TgSBVc2luZyBsb2NhbCBHZW9KU09OIGZpbGU6ICR7bG9jYWxQYXRofWApO1xuICAgICAgY29uc3QgZmlsZUNvbnRlbnQgPSBmcy5yZWFkRmlsZVN5bmMobG9jYWxQYXRoLCAndXRmLTgnKTtcbiAgICAgIHJldHVybiBKU09OLnBhcnNlKGZpbGVDb250ZW50KTtcbiAgICB9XG5cbiAgICBpZiAoIWNvbGxlY3Rpb24pIHtcbiAgICAgIGNvbnNvbGUud2FybihgUE9JIGNvbGxlY3Rpb24gJHtjb2xsZWN0aW9uSWR9IG5vdCBmb3VuZCBpbiBjb25maWcgYW5kIG5vIGxvY2FsIGZpbGUgZm91bmRgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS53YXJuKGBHZW9KU09OIGZpbGUgbm90IGZvdW5kIGluIFMzIG9yIGxvY2FsbHkgZm9yIGNvbGxlY3Rpb24gJHtjb2xsZWN0aW9uSWR9YCk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgcmVhZGluZyBHZW9KU09OIGZvciBjb2xsZWN0aW9uICR7Y29sbGVjdGlvbklkfTpgLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLyoqXG4gKiBTYXZlIFBPSSBjb2xsZWN0aW9uIEdlb0pTT04gdG8gUzNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHB1dFBPSUNvbGxlY3Rpb24oY29sbGVjdGlvbklkOiBzdHJpbmcsIGdlb2pzb246IGFueSk6IFByb21pc2U8dm9pZD4ge1xuICBpZiAoIXByb2Nlc3MuZW52LkFXU19BQ0NFU1NfS0VZX0lEIHx8ICFwcm9jZXNzLmVudi5BV1NfU0VDUkVUX0FDQ0VTU19LRVkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0FXUyBjcmVkZW50aWFscyBub3QgY29uZmlndXJlZCcpO1xuICB9XG5cbiAgY29uc3QgY29tbWFuZCA9IG5ldyBQdXRPYmplY3RDb21tYW5kKHtcbiAgICBCdWNrZXQ6IEJVQ0tFVCxcbiAgICBLZXk6IGBwb2lzLyR7Y29sbGVjdGlvbklkfS5nZW9qc29uYCxcbiAgICBCb2R5OiBKU09OLnN0cmluZ2lmeShnZW9qc29uLCBudWxsLCAyKSxcbiAgICBDb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICB9KTtcbiAgXG4gIGF3YWl0IHMzQ2xpZW50LnNlbmQoY29tbWFuZCk7XG59XG4iXSwibmFtZXMiOlsiUzNDbGllbnQiLCJHZXRPYmplY3RDb21tYW5kIiwiUHV0T2JqZWN0Q29tbWFuZCIsIkhlYWRPYmplY3RDb21tYW5kIiwiZnMiLCJwYXRoIiwiczNDbGllbnQiLCJyZWdpb24iLCJwcm9jZXNzIiwiZW52IiwiQVdTX1JFR0lPTiIsImNyZWRlbnRpYWxzIiwiYWNjZXNzS2V5SWQiLCJBV1NfQUNDRVNTX0tFWV9JRCIsInNlY3JldEFjY2Vzc0tleSIsIkFXU19TRUNSRVRfQUNDRVNTX0tFWSIsIkJVQ0tFVCIsIlMzX0JVQ0tFVCIsImNvbmZpZ0V4aXN0cyIsImtleSIsInNlbmQiLCJCdWNrZXQiLCJLZXkiLCJlcnJvciIsIm5hbWUiLCIkbWV0YWRhdGEiLCJodHRwU3RhdHVzQ29kZSIsImdldENvbmZpZyIsImNvbnNvbGUiLCJ3YXJuIiwiY29tbWFuZCIsInJlc3BvbnNlIiwiYm9keSIsIkJvZHkiLCJ0cmFuc2Zvcm1Ub1N0cmluZyIsIkpTT04iLCJwYXJzZSIsIm1lc3NhZ2UiLCJwdXRDb25maWciLCJkYXRhIiwiRXJyb3IiLCJqc29uIiwic3RyaW5naWZ5IiwiQ29udGVudFR5cGUiLCJsb2ciLCJpbml0Q29uZmlnSWZOZWVkZWQiLCJkZWZhdWx0RGF0YSIsImV4aXN0cyIsImV4aXN0aW5nIiwidXBkYXRlQ29uZmlnIiwidXBkYXRlciIsInVwZGF0ZWQiLCJsaXN0T2JqZWN0cyIsInByZWZpeCIsIkxpc3RPYmplY3RzVjJDb21tYW5kIiwiUHJlZml4IiwiQ29udGVudHMiLCJtYXAiLCJvYmoiLCJmaWx0ZXIiLCJCb29sZWFuIiwiZ2V0UE9JQ29sbGVjdGlvbiIsImNvbGxlY3Rpb25JZCIsImNvbGxlY3Rpb25zIiwiY29sbGVjdGlvbiIsImdlb2pzb25LZXkiLCJnZW9qc29uUGF0aCIsInMzRXJyb3IiLCJsb2NhbEZpbGVNYXAiLCJsb2NhbEZpbGVOYW1lIiwicmVwbGFjZSIsImxvY2FsUGF0aCIsImpvaW4iLCJjd2QiLCJleGlzdHNTeW5jIiwiZmlsZUNvbnRlbnQiLCJyZWFkRmlsZVN5bmMiLCJwdXRQT0lDb2xsZWN0aW9uIiwiZ2VvanNvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/s3-config.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Faudit%2Froute&page=%2Fapi%2Faudit%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Faudit%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();