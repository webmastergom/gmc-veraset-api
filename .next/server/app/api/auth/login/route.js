"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/login/route";
exports.ids = ["app/api/auth/login/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_juliangarritz_dev_py_veraset_veraset_api_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/login/route.ts */ \"(rsc)/./app/api/auth/login/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/login/route\",\n        pathname: \"/api/auth/login\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/login/route\"\n    },\n    resolvedPagePath: \"/Users/juliangarritz/dev/py/veraset/veraset-api/app/api/auth/login/route.ts\",\n    nextConfigOutput,\n    userland: _Users_juliangarritz_dev_py_veraset_veraset_api_app_api_auth_login_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/login/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGbG9naW4lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkZsb2dpbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmp1bGlhbmdhcnJpdHolMkZkZXYlMkZweSUyRnZlcmFzZXQlMkZ2ZXJhc2V0LWFwaSUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZqdWxpYW5nYXJyaXR6JTJGZGV2JTJGcHklMkZ2ZXJhc2V0JTJGdmVyYXNldC1hcGkmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzJCO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLz8zNTcyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9qdWxpYW5nYXJyaXR6L2Rldi9weS92ZXJhc2V0L3ZlcmFzZXQtYXBpL2FwcC9hcGkvYXV0aC9sb2dpbi9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYXV0aC9sb2dpbi9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2F1dGgvbG9naW5cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvbG9naW4vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvanVsaWFuZ2Fycml0ei9kZXYvcHkvdmVyYXNldC92ZXJhc2V0LWFwaS9hcHAvYXBpL2F1dGgvbG9naW4vcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2F1dGgvbG9naW4vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/login/route.ts":
/*!*************************************!*\
  !*** ./app/api/auth/login/route.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n/* harmony import */ var _lib_security__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/security */ \"(rsc)/./lib/security.ts\");\n/* harmony import */ var _lib_validation__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/validation */ \"(rsc)/./lib/validation.ts\");\n/* harmony import */ var _lib_logger__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/logger */ \"(rsc)/./lib/logger.ts\");\n\n\n\n\n\n\nasync function POST(req) {\n    try {\n        // Rate limiting for login endpoint (stricter)\n        const clientId = (0,_lib_security__WEBPACK_IMPORTED_MODULE_3__.getClientIdentifier)(req);\n        const rateLimit = (0,_lib_security__WEBPACK_IMPORTED_MODULE_3__.checkRateLimit)(`login:${clientId}`, 5, 900000) // 5 attempts per 15 minutes\n        ;\n        if (!rateLimit.allowed) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Too many login attempts. Please try again later.\"\n            }, {\n                status: 429,\n                headers: {\n                    \"Retry-After\": String(Math.ceil((rateLimit.resetAt - Date.now()) / 1000)),\n                    \"X-RateLimit-Limit\": \"5\",\n                    \"X-RateLimit-Remaining\": \"0\",\n                    \"X-RateLimit-Reset\": String(Math.floor(rateLimit.resetAt / 1000))\n                }\n            });\n        }\n        // Validate request body\n        const validation = await (0,_lib_validation__WEBPACK_IMPORTED_MODULE_4__.validateRequestBody)(req, _lib_validation__WEBPACK_IMPORTED_MODULE_4__.loginSchema);\n        if (!validation.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: validation.error\n            }, {\n                status: validation.status\n            });\n        }\n        const { username, password } = validation.data;\n        // Check if environment variables are configured\n        const authSecret = process.env.AUTH_SECRET;\n        if (!authSecret) {\n            const isProduction = \"development\" === \"production\";\n            const errorMessage = isProduction ? \"Server configuration error\" : \"AUTH_SECRET not configured\";\n            _lib_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Auth configuration missing: AUTH_SECRET\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: errorMessage\n            }, {\n                status: 500\n            });\n        }\n        // Verify credentials\n        if ((0,_lib_auth__WEBPACK_IMPORTED_MODULE_2__.verifyCredentials)(username, password)) {\n            // Set auth token cookie\n            (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)().set(\"auth-token\", authSecret, {\n                httpOnly: true,\n                secure: \"development\" === \"production\",\n                sameSite:  false ? 0 : \"lax\",\n                maxAge: 60 * 60 * 24 * 7,\n                path: \"/\"\n            });\n            _lib_logger__WEBPACK_IMPORTED_MODULE_5__.logger.info(\"Successful login\", {\n                username: username.substring(0, 3) + \"***\"\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true\n            });\n        }\n        // Don't reveal whether username or password was wrong (security best practice)\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Invalid credentials\"\n        }, {\n            status: 401,\n            headers: {\n                \"X-RateLimit-Limit\": \"5\",\n                \"X-RateLimit-Remaining\": String(rateLimit.remaining - 1),\n                \"X-RateLimit-Reset\": String(Math.floor(rateLimit.resetAt / 1000))\n            }\n        });\n    } catch (error) {\n        _lib_logger__WEBPACK_IMPORTED_MODULE_5__.logger.error(\"Login error:\", error);\n        const isProduction = \"development\" === \"production\";\n        const errorMessage = (0,_lib_security__WEBPACK_IMPORTED_MODULE_3__.sanitizeError)(error, isProduction);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: errorMessage\n        }, {\n            status: 400\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBT29CO1FBQWEsR0FDdEI7WUFBRW5CLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLy4vYXBwL2FwaS9hdXRoL2xvZ2luL3JvdXRlLnRzPzRmMjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xuaW1wb3J0IHsgdmVyaWZ5Q3JlZGVudGlhbHMgfSBmcm9tICdAL2xpYi9hdXRoJ1xuaW1wb3J0IHsgY2hlY2tSYXRlTGltaXQsIGdldENsaWVudElkZW50aWZpZXIsIHNhbml0aXplRXJyb3IgfSBmcm9tICdAL2xpYi9zZWN1cml0eSdcbmltcG9ydCB7IHZhbGlkYXRlUmVxdWVzdEJvZHksIGxvZ2luU2NoZW1hIH0gZnJvbSAnQC9saWIvdmFsaWRhdGlvbidcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvbGliL2xvZ2dlcidcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgLy8gUmF0ZSBsaW1pdGluZyBmb3IgbG9naW4gZW5kcG9pbnQgKHN0cmljdGVyKVxuICAgIGNvbnN0IGNsaWVudElkID0gZ2V0Q2xpZW50SWRlbnRpZmllcihyZXEpXG4gICAgY29uc3QgcmF0ZUxpbWl0ID0gY2hlY2tSYXRlTGltaXQoYGxvZ2luOiR7Y2xpZW50SWR9YCwgNSwgOTAwMDAwKSAvLyA1IGF0dGVtcHRzIHBlciAxNSBtaW51dGVzXG4gICAgXG4gICAgaWYgKCFyYXRlTGltaXQuYWxsb3dlZCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnVG9vIG1hbnkgbG9naW4gYXR0ZW1wdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyB9LFxuICAgICAgICB7XG4gICAgICAgICAgc3RhdHVzOiA0MjksXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ1JldHJ5LUFmdGVyJzogU3RyaW5nKE1hdGguY2VpbCgocmF0ZUxpbWl0LnJlc2V0QXQgLSBEYXRlLm5vdygpKSAvIDEwMDApKSxcbiAgICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6ICc1JyxcbiAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiAnMCcsXG4gICAgICAgICAgICAnWC1SYXRlTGltaXQtUmVzZXQnOiBTdHJpbmcoTWF0aC5mbG9vcihyYXRlTGltaXQucmVzZXRBdCAvIDEwMDApKSxcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIC8vIFZhbGlkYXRlIHJlcXVlc3QgYm9keVxuICAgIGNvbnN0IHZhbGlkYXRpb24gPSBhd2FpdCB2YWxpZGF0ZVJlcXVlc3RCb2R5KHJlcSwgbG9naW5TY2hlbWEpO1xuICAgIGlmICghdmFsaWRhdGlvbi5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6IHZhbGlkYXRpb24uZXJyb3IgfSxcbiAgICAgICAgeyBzdGF0dXM6IHZhbGlkYXRpb24uc3RhdHVzIH1cbiAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHsgdXNlcm5hbWUsIHBhc3N3b3JkIH0gPSB2YWxpZGF0aW9uLmRhdGE7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSBjb25maWd1cmVkXG4gICAgY29uc3QgYXV0aFNlY3JldCA9IHByb2Nlc3MuZW52LkFVVEhfU0VDUkVUXG4gICAgXG4gICAgaWYgKCFhdXRoU2VjcmV0KSB7XG4gICAgICBjb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nXG4gICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBpc1Byb2R1Y3Rpb25cbiAgICAgICAgPyAnU2VydmVyIGNvbmZpZ3VyYXRpb24gZXJyb3InXG4gICAgICAgIDogJ0FVVEhfU0VDUkVUIG5vdCBjb25maWd1cmVkJ1xuICAgICAgXG4gICAgICBsb2dnZXIuZXJyb3IoJ0F1dGggY29uZmlndXJhdGlvbiBtaXNzaW5nOiBBVVRIX1NFQ1JFVCcpXG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogZXJyb3JNZXNzYWdlIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKVxuICAgIH1cbiAgICBcbiAgICAvLyBWZXJpZnkgY3JlZGVudGlhbHNcbiAgICBpZiAodmVyaWZ5Q3JlZGVudGlhbHModXNlcm5hbWUsIHBhc3N3b3JkKSkge1xuICAgICAgLy8gU2V0IGF1dGggdG9rZW4gY29va2llXG4gICAgICBjb29raWVzKCkuc2V0KCdhdXRoLXRva2VuJywgYXV0aFNlY3JldCwge1xuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxuICAgICAgICBzYW1lU2l0ZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyA/ICdzdHJpY3QnIDogJ2xheCcsIC8vICdsYXgnIGluIGRldiBmb3IgZmV0Y2ggY29tcGF0aWJpbGl0eSwgJ3N0cmljdCcgaW4gcHJvZHVjdGlvblxuICAgICAgICBtYXhBZ2U6IDYwICogNjAgKiAyNCAqIDcsIC8vIDcgZGF5c1xuICAgICAgICBwYXRoOiAnLycsXG4gICAgICB9KVxuICAgICAgXG4gICAgICBsb2dnZXIuaW5mbygnU3VjY2Vzc2Z1bCBsb2dpbicsIHsgdXNlcm5hbWU6IHVzZXJuYW1lLnN1YnN0cmluZygwLCAzKSArICcqKionIH0pXG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gRG9uJ3QgcmV2ZWFsIHdoZXRoZXIgdXNlcm5hbWUgb3IgcGFzc3dvcmQgd2FzIHdyb25nIChzZWN1cml0eSBiZXN0IHByYWN0aWNlKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIGNyZWRlbnRpYWxzJyB9LFxuICAgICAge1xuICAgICAgICBzdGF0dXM6IDQwMSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6ICc1JyxcbiAgICAgICAgICAnWC1SYXRlTGltaXQtUmVtYWluaW5nJzogU3RyaW5nKHJhdGVMaW1pdC5yZW1haW5pbmcgLSAxKSxcbiAgICAgICAgICAnWC1SYXRlTGltaXQtUmVzZXQnOiBTdHJpbmcoTWF0aC5mbG9vcihyYXRlTGltaXQucmVzZXRBdCAvIDEwMDApKSxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdMb2dpbiBlcnJvcjonLCBlcnJvcilcbiAgICBjb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gc2FuaXRpemVFcnJvcihlcnJvciwgaXNQcm9kdWN0aW9uKVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6IGVycm9yTWVzc2FnZSB9LFxuICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgKVxuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY29va2llcyIsInZlcmlmeUNyZWRlbnRpYWxzIiwiY2hlY2tSYXRlTGltaXQiLCJnZXRDbGllbnRJZGVudGlmaWVyIiwic2FuaXRpemVFcnJvciIsInZhbGlkYXRlUmVxdWVzdEJvZHkiLCJsb2dpblNjaGVtYSIsImxvZ2dlciIsIlBPU1QiLCJyZXEiLCJjbGllbnRJZCIsInJhdGVMaW1pdCIsImFsbG93ZWQiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJoZWFkZXJzIiwiU3RyaW5nIiwiTWF0aCIsImNlaWwiLCJyZXNldEF0IiwiRGF0ZSIsIm5vdyIsImZsb29yIiwidmFsaWRhdGlvbiIsInN1Y2Nlc3MiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZGF0YSIsImF1dGhTZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiQVVUSF9TRUNSRVQiLCJpc1Byb2R1Y3Rpb24iLCJlcnJvck1lc3NhZ2UiLCJzZXQiLCJodHRwT25seSIsInNlY3VyZSIsInNhbWVTaXRlIiwibWF4QWdlIiwicGF0aCIsImluZm8iLCJzdWJzdHJpbmciLCJyZW1haW5pbmciXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/login/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateSecureToken: () => (/* binding */ generateSecureToken),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   isAuthenticated: () => (/* binding */ isAuthenticated),\n/* harmony export */   verifyCredentials: () => (/* binding */ verifyCredentials),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n/**\n * Authentication utilities\n */ \n\n/**\n * Verify if a request is authenticated\n */ function isAuthenticated(request) {\n    if (request) {\n        const authCookie = request.cookies.get(\"auth-token\");\n        return authCookie?.value === process.env.AUTH_SECRET;\n    }\n    // Server-side check using cookies()\n    try {\n        const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n        const authCookie = cookieStore.get(\"auth-token\");\n        return authCookie?.value === process.env.AUTH_SECRET;\n    } catch  {\n        return false;\n    }\n}\n/**\n * Hash a password using SHA-256 (for basic security)\n * Note: For production, consider using bcrypt or argon2\n */ function hashPassword(password, salt) {\n    const actualSalt = salt || crypto__WEBPACK_IMPORTED_MODULE_1___default().randomBytes(16).toString(\"hex\");\n    const hash = crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"sha256\").update(password + actualSalt).digest(\"hex\");\n    return {\n        hash,\n        salt: actualSalt\n    };\n}\n/**\n * Verify a password against a hash\n */ function verifyPassword(password, hash, salt) {\n    const { hash: computedHash } = hashPassword(password, salt);\n    return computedHash === hash;\n}\n/**\n * Generate a secure random token\n */ function generateSecureToken(length = 32) {\n    return crypto__WEBPACK_IMPORTED_MODULE_1___default().randomBytes(length).toString(\"base64url\");\n}\n/**\n * Verify credentials (with optional password hashing)\n */ function verifyCredentials(username, password) {\n    const authUsername = process.env.AUTH_USERNAME;\n    const authPassword = process.env.AUTH_PASSWORD;\n    if (!authUsername || !authPassword) {\n        return false;\n    }\n    // Check if password is hashed (has salt stored)\n    const passwordHash = process.env.AUTH_PASSWORD_HASH;\n    const passwordSalt = process.env.AUTH_PASSWORD_SALT;\n    if (passwordHash && passwordSalt) {\n        // Use hashed password verification\n        return username === authUsername && verifyPassword(password, passwordHash, passwordSalt);\n    }\n    // Fallback to plain text comparison (less secure, but backward compatible)\n    return username === authUsername && password === authPassword;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztDQUVDLEdBRXFDO0FBRVg7QUFFM0I7O0NBRUMsR0FDTSxTQUFTRSxnQkFBZ0JDLE9BQXFCO0lBQ25ELElBQUlBLFNBQVM7UUFDWCxNQUFNQyxhQUFhRCxRQUFRSCxPQUFPLENBQUNLLEdBQUcsQ0FBQztRQUN2QyxPQUFPRCxZQUFZRSxVQUFVQyxRQUFRQyxHQUFHLENBQUNDLFdBQVc7SUFDdEQ7SUFFQSxvQ0FBb0M7SUFDcEMsSUFBSTtRQUNGLE1BQU1DLGNBQWNWLHFEQUFPQTtRQUMzQixNQUFNSSxhQUFhTSxZQUFZTCxHQUFHLENBQUM7UUFDbkMsT0FBT0QsWUFBWUUsVUFBVUMsUUFBUUMsR0FBRyxDQUFDQyxXQUFXO0lBQ3RELEVBQUUsT0FBTTtRQUNOLE9BQU87SUFDVDtBQUNGO0FBRUE7OztDQUdDLEdBQ00sU0FBU0UsYUFBYUMsUUFBZ0IsRUFBRUMsSUFBYTtJQUMxRCxNQUFNQyxhQUFhRCxRQUFRWix5REFBa0IsQ0FBQyxJQUFJZSxRQUFRLENBQUM7SUFDM0QsTUFBTUMsT0FBT2hCLHdEQUNBLENBQUMsVUFDWGtCLE1BQU0sQ0FBQ1AsV0FBV0UsWUFDbEJNLE1BQU0sQ0FBQztJQUVWLE9BQU87UUFBRUg7UUFBTUosTUFBTUM7SUFBVztBQUNsQztBQUVBOztDQUVDLEdBQ00sU0FBU08sZUFBZVQsUUFBZ0IsRUFBRUssSUFBWSxFQUFFSixJQUFZO0lBQ3pFLE1BQU0sRUFBRUksTUFBTUssWUFBWSxFQUFFLEdBQUdYLGFBQWFDLFVBQVVDO0lBQ3RELE9BQU9TLGlCQUFpQkw7QUFDMUI7QUFFQTs7Q0FFQyxHQUNNLFNBQVNNLG9CQUFvQkMsU0FBaUIsRUFBRTtJQUNyRCxPQUFPdkIseURBQWtCLENBQUN1QixRQUFRUixRQUFRLENBQUM7QUFDN0M7QUFFQTs7Q0FFQyxHQUNNLFNBQVNTLGtCQUNkQyxRQUFnQixFQUNoQmQsUUFBZ0I7SUFFaEIsTUFBTWUsZUFBZXBCLFFBQVFDLEdBQUcsQ0FBQ29CLGFBQWE7SUFDOUMsTUFBTUMsZUFBZXRCLFFBQVFDLEdBQUcsQ0FBQ3NCLGFBQWE7SUFFOUMsSUFBSSxDQUFDSCxnQkFBZ0IsQ0FBQ0UsY0FBYztRQUNsQyxPQUFPO0lBQ1Q7SUFFQSxnREFBZ0Q7SUFDaEQsTUFBTUUsZUFBZXhCLFFBQVFDLEdBQUcsQ0FBQ3dCLGtCQUFrQjtJQUNuRCxNQUFNQyxlQUFlMUIsUUFBUUMsR0FBRyxDQUFDMEIsa0JBQWtCO0lBRW5ELElBQUlILGdCQUFnQkUsY0FBYztRQUNoQyxtQ0FBbUM7UUFDbkMsT0FBT1AsYUFBYUMsZ0JBQWdCTixlQUFlVCxVQUFVbUIsY0FBY0U7SUFDN0U7SUFFQSwyRUFBMkU7SUFDM0UsT0FBT1AsYUFBYUMsZ0JBQWdCZixhQUFhaUI7QUFDbkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nbWMtdmVyYXNldC1hcGkvLi9saWIvYXV0aC50cz9iZjdlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQXV0aGVudGljYXRpb24gdXRpbGl0aWVzXG4gKi9cblxuaW1wb3J0IHsgY29va2llcyB9IGZyb20gJ25leHQvaGVhZGVycydcbmltcG9ydCB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0bydcblxuLyoqXG4gKiBWZXJpZnkgaWYgYSByZXF1ZXN0IGlzIGF1dGhlbnRpY2F0ZWRcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZChyZXF1ZXN0PzogTmV4dFJlcXVlc3QpOiBib29sZWFuIHtcbiAgaWYgKHJlcXVlc3QpIHtcbiAgICBjb25zdCBhdXRoQ29va2llID0gcmVxdWVzdC5jb29raWVzLmdldCgnYXV0aC10b2tlbicpXG4gICAgcmV0dXJuIGF1dGhDb29raWU/LnZhbHVlID09PSBwcm9jZXNzLmVudi5BVVRIX1NFQ1JFVFxuICB9XG4gIFxuICAvLyBTZXJ2ZXItc2lkZSBjaGVjayB1c2luZyBjb29raWVzKClcbiAgdHJ5IHtcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKVxuICAgIGNvbnN0IGF1dGhDb29raWUgPSBjb29raWVTdG9yZS5nZXQoJ2F1dGgtdG9rZW4nKVxuICAgIHJldHVybiBhdXRoQ29va2llPy52YWx1ZSA9PT0gcHJvY2Vzcy5lbnYuQVVUSF9TRUNSRVRcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuLyoqXG4gKiBIYXNoIGEgcGFzc3dvcmQgdXNpbmcgU0hBLTI1NiAoZm9yIGJhc2ljIHNlY3VyaXR5KVxuICogTm90ZTogRm9yIHByb2R1Y3Rpb24sIGNvbnNpZGVyIHVzaW5nIGJjcnlwdCBvciBhcmdvbjJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGhhc2hQYXNzd29yZChwYXNzd29yZDogc3RyaW5nLCBzYWx0Pzogc3RyaW5nKTogeyBoYXNoOiBzdHJpbmc7IHNhbHQ6IHN0cmluZyB9IHtcbiAgY29uc3QgYWN0dWFsU2FsdCA9IHNhbHQgfHwgY3J5cHRvLnJhbmRvbUJ5dGVzKDE2KS50b1N0cmluZygnaGV4JylcbiAgY29uc3QgaGFzaCA9IGNyeXB0b1xuICAgIC5jcmVhdGVIYXNoKCdzaGEyNTYnKVxuICAgIC51cGRhdGUocGFzc3dvcmQgKyBhY3R1YWxTYWx0KVxuICAgIC5kaWdlc3QoJ2hleCcpXG4gIFxuICByZXR1cm4geyBoYXNoLCBzYWx0OiBhY3R1YWxTYWx0IH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgYSBwYXNzd29yZCBhZ2FpbnN0IGEgaGFzaFxuICovXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5UGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZywgaGFzaDogc3RyaW5nLCBzYWx0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgY29uc3QgeyBoYXNoOiBjb21wdXRlZEhhc2ggfSA9IGhhc2hQYXNzd29yZChwYXNzd29yZCwgc2FsdClcbiAgcmV0dXJuIGNvbXB1dGVkSGFzaCA9PT0gaGFzaFxufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgc2VjdXJlIHJhbmRvbSB0b2tlblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVTZWN1cmVUb2tlbihsZW5ndGg6IG51bWJlciA9IDMyKTogc3RyaW5nIHtcbiAgcmV0dXJuIGNyeXB0by5yYW5kb21CeXRlcyhsZW5ndGgpLnRvU3RyaW5nKCdiYXNlNjR1cmwnKVxufVxuXG4vKipcbiAqIFZlcmlmeSBjcmVkZW50aWFscyAod2l0aCBvcHRpb25hbCBwYXNzd29yZCBoYXNoaW5nKVxuICovXG5leHBvcnQgZnVuY3Rpb24gdmVyaWZ5Q3JlZGVudGlhbHMoXG4gIHVzZXJuYW1lOiBzdHJpbmcsXG4gIHBhc3N3b3JkOiBzdHJpbmdcbik6IGJvb2xlYW4ge1xuICBjb25zdCBhdXRoVXNlcm5hbWUgPSBwcm9jZXNzLmVudi5BVVRIX1VTRVJOQU1FXG4gIGNvbnN0IGF1dGhQYXNzd29yZCA9IHByb2Nlc3MuZW52LkFVVEhfUEFTU1dPUkRcbiAgXG4gIGlmICghYXV0aFVzZXJuYW1lIHx8ICFhdXRoUGFzc3dvcmQpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuICBcbiAgLy8gQ2hlY2sgaWYgcGFzc3dvcmQgaXMgaGFzaGVkIChoYXMgc2FsdCBzdG9yZWQpXG4gIGNvbnN0IHBhc3N3b3JkSGFzaCA9IHByb2Nlc3MuZW52LkFVVEhfUEFTU1dPUkRfSEFTSFxuICBjb25zdCBwYXNzd29yZFNhbHQgPSBwcm9jZXNzLmVudi5BVVRIX1BBU1NXT1JEX1NBTFRcbiAgXG4gIGlmIChwYXNzd29yZEhhc2ggJiYgcGFzc3dvcmRTYWx0KSB7XG4gICAgLy8gVXNlIGhhc2hlZCBwYXNzd29yZCB2ZXJpZmljYXRpb25cbiAgICByZXR1cm4gdXNlcm5hbWUgPT09IGF1dGhVc2VybmFtZSAmJiB2ZXJpZnlQYXNzd29yZChwYXNzd29yZCwgcGFzc3dvcmRIYXNoLCBwYXNzd29yZFNhbHQpXG4gIH1cbiAgXG4gIC8vIEZhbGxiYWNrIHRvIHBsYWluIHRleHQgY29tcGFyaXNvbiAobGVzcyBzZWN1cmUsIGJ1dCBiYWNrd2FyZCBjb21wYXRpYmxlKVxuICByZXR1cm4gdXNlcm5hbWUgPT09IGF1dGhVc2VybmFtZSAmJiBwYXNzd29yZCA9PT0gYXV0aFBhc3N3b3JkXG59XG4iXSwibmFtZXMiOlsiY29va2llcyIsImNyeXB0byIsImlzQXV0aGVudGljYXRlZCIsInJlcXVlc3QiLCJhdXRoQ29va2llIiwiZ2V0IiwidmFsdWUiLCJwcm9jZXNzIiwiZW52IiwiQVVUSF9TRUNSRVQiLCJjb29raWVTdG9yZSIsImhhc2hQYXNzd29yZCIsInBhc3N3b3JkIiwic2FsdCIsImFjdHVhbFNhbHQiLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwiaGFzaCIsImNyZWF0ZUhhc2giLCJ1cGRhdGUiLCJkaWdlc3QiLCJ2ZXJpZnlQYXNzd29yZCIsImNvbXB1dGVkSGFzaCIsImdlbmVyYXRlU2VjdXJlVG9rZW4iLCJsZW5ndGgiLCJ2ZXJpZnlDcmVkZW50aWFscyIsInVzZXJuYW1lIiwiYXV0aFVzZXJuYW1lIiwiQVVUSF9VU0VSTkFNRSIsImF1dGhQYXNzd29yZCIsIkFVVEhfUEFTU1dPUkQiLCJwYXNzd29yZEhhc2giLCJBVVRIX1BBU1NXT1JEX0hBU0giLCJwYXNzd29yZFNhbHQiLCJBVVRIX1BBU1NXT1JEX1NBTFQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/logger.ts":
/*!***********************!*\
  !*** ./lib/logger.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   logger: () => (/* binding */ logger)\n/* harmony export */ });\n/**\n * Secure logging utilities\n * Prevents sensitive information from being logged in production\n */ const isProduction = \"development\" === \"production\";\n/**\n * Sanitize data before logging\n */ function sanitizeForLogging(data) {\n    if (typeof data !== \"object\" || data === null) {\n        return data;\n    }\n    if (Array.isArray(data)) {\n        return data.map(sanitizeForLogging);\n    }\n    const sensitiveKeys = [\n        \"password\",\n        \"secret\",\n        \"token\",\n        \"key\",\n        \"auth\",\n        \"credential\",\n        \"api_key\",\n        \"access_key\",\n        \"secret_key\"\n    ];\n    const sanitized = {};\n    for (const [key, value] of Object.entries(data)){\n        const lowerKey = key.toLowerCase();\n        const isSensitive = sensitiveKeys.some((sk)=>lowerKey.includes(sk));\n        if (isSensitive && isProduction) {\n            sanitized[key] = \"[REDACTED]\";\n        } else if (typeof value === \"object\" && value !== null) {\n            sanitized[key] = sanitizeForLogging(value);\n        } else {\n            sanitized[key] = value;\n        }\n    }\n    return sanitized;\n}\n/**\n * Safe logger that redacts sensitive information in production\n */ const logger = {\n    log: (...args)=>{\n        if (!isProduction) {\n            console.log(...args);\n        } else {\n            // In production, sanitize logs\n            const sanitized = args.map(sanitizeForLogging);\n            console.log(...sanitized);\n        }\n    },\n    error: (message, error)=>{\n        if (!isProduction) {\n            console.error(message, error);\n        } else {\n            // In production, only log error messages, not full error objects\n            const sanitizedError = error instanceof Error ? {\n                message: error.message,\n                name: error.name\n            } : sanitizeForLogging(error);\n            console.error(message, sanitizedError);\n        }\n    },\n    warn: (...args)=>{\n        if (!isProduction) {\n            console.warn(...args);\n        } else {\n            const sanitized = args.map(sanitizeForLogging);\n            console.warn(...sanitized);\n        }\n    },\n    info: (...args)=>{\n        if (!isProduction) {\n            console.info(...args);\n        } else {\n            const sanitized = args.map(sanitizeForLogging);\n            console.info(...sanitized);\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbG9nZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTs7O0NBR0MsR0FFRCxNQUFNQSxlQUFlQyxrQkFBeUI7QUFFOUM7O0NBRUMsR0FDRCxTQUFTQyxtQkFBbUJDLElBQWE7SUFDdkMsSUFBSSxPQUFPQSxTQUFTLFlBQVlBLFNBQVMsTUFBTTtRQUM3QyxPQUFPQTtJQUNUO0lBRUEsSUFBSUMsTUFBTUMsT0FBTyxDQUFDRixPQUFPO1FBQ3ZCLE9BQU9BLEtBQUtHLEdBQUcsQ0FBQ0o7SUFDbEI7SUFFQSxNQUFNSyxnQkFBZ0I7UUFDcEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFFRCxNQUFNQyxZQUFxQyxDQUFDO0lBRTVDLEtBQUssTUFBTSxDQUFDQyxLQUFLQyxNQUFNLElBQUlDLE9BQU9DLE9BQU8sQ0FBQ1QsTUFBTztRQUMvQyxNQUFNVSxXQUFXSixJQUFJSyxXQUFXO1FBQ2hDLE1BQU1DLGNBQWNSLGNBQWNTLElBQUksQ0FBQ0MsQ0FBQUEsS0FBTUosU0FBU0ssUUFBUSxDQUFDRDtRQUUvRCxJQUFJRixlQUFlZixjQUFjO1lBQy9CUSxTQUFTLENBQUNDLElBQUksR0FBRztRQUNuQixPQUFPLElBQUksT0FBT0MsVUFBVSxZQUFZQSxVQUFVLE1BQU07WUFDdERGLFNBQVMsQ0FBQ0MsSUFBSSxHQUFHUCxtQkFBbUJRO1FBQ3RDLE9BQU87WUFDTEYsU0FBUyxDQUFDQyxJQUFJLEdBQUdDO1FBQ25CO0lBQ0Y7SUFFQSxPQUFPRjtBQUNUO0FBRUE7O0NBRUMsR0FDTSxNQUFNVyxTQUFTO0lBQ3BCQyxLQUFLLENBQUMsR0FBR0M7UUFDUCxJQUFJLENBQUNyQixjQUFjO1lBQ2pCc0IsUUFBUUYsR0FBRyxJQUFJQztRQUNqQixPQUFPO1lBQ0wsK0JBQStCO1lBQy9CLE1BQU1iLFlBQVlhLEtBQUtmLEdBQUcsQ0FBQ0o7WUFDM0JvQixRQUFRRixHQUFHLElBQUlaO1FBQ2pCO0lBQ0Y7SUFFQWUsT0FBTyxDQUFDQyxTQUFpQkQ7UUFDdkIsSUFBSSxDQUFDdkIsY0FBYztZQUNqQnNCLFFBQVFDLEtBQUssQ0FBQ0MsU0FBU0Q7UUFDekIsT0FBTztZQUNMLGlFQUFpRTtZQUNqRSxNQUFNRSxpQkFBaUJGLGlCQUFpQkcsUUFDcEM7Z0JBQUVGLFNBQVNELE1BQU1DLE9BQU87Z0JBQUVHLE1BQU1KLE1BQU1JLElBQUk7WUFBQyxJQUMzQ3pCLG1CQUFtQnFCO1lBQ3ZCRCxRQUFRQyxLQUFLLENBQUNDLFNBQVNDO1FBQ3pCO0lBQ0Y7SUFFQUcsTUFBTSxDQUFDLEdBQUdQO1FBQ1IsSUFBSSxDQUFDckIsY0FBYztZQUNqQnNCLFFBQVFNLElBQUksSUFBSVA7UUFDbEIsT0FBTztZQUNMLE1BQU1iLFlBQVlhLEtBQUtmLEdBQUcsQ0FBQ0o7WUFDM0JvQixRQUFRTSxJQUFJLElBQUlwQjtRQUNsQjtJQUNGO0lBRUFxQixNQUFNLENBQUMsR0FBR1I7UUFDUixJQUFJLENBQUNyQixjQUFjO1lBQ2pCc0IsUUFBUU8sSUFBSSxJQUFJUjtRQUNsQixPQUFPO1lBQ0wsTUFBTWIsWUFBWWEsS0FBS2YsR0FBRyxDQUFDSjtZQUMzQm9CLFFBQVFPLElBQUksSUFBSXJCO1FBQ2xCO0lBQ0Y7QUFDRixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLy4vbGliL2xvZ2dlci50cz9mZDVkIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU2VjdXJlIGxvZ2dpbmcgdXRpbGl0aWVzXG4gKiBQcmV2ZW50cyBzZW5zaXRpdmUgaW5mb3JtYXRpb24gZnJvbSBiZWluZyBsb2dnZWQgaW4gcHJvZHVjdGlvblxuICovXG5cbmNvbnN0IGlzUHJvZHVjdGlvbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbidcblxuLyoqXG4gKiBTYW5pdGl6ZSBkYXRhIGJlZm9yZSBsb2dnaW5nXG4gKi9cbmZ1bmN0aW9uIHNhbml0aXplRm9yTG9nZ2luZyhkYXRhOiB1bmtub3duKTogdW5rbm93biB7XG4gIGlmICh0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcgfHwgZGF0YSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBkYXRhXG4gIH1cbiAgXG4gIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7XG4gICAgcmV0dXJuIGRhdGEubWFwKHNhbml0aXplRm9yTG9nZ2luZylcbiAgfVxuICBcbiAgY29uc3Qgc2Vuc2l0aXZlS2V5cyA9IFtcbiAgICAncGFzc3dvcmQnLFxuICAgICdzZWNyZXQnLFxuICAgICd0b2tlbicsXG4gICAgJ2tleScsXG4gICAgJ2F1dGgnLFxuICAgICdjcmVkZW50aWFsJyxcbiAgICAnYXBpX2tleScsXG4gICAgJ2FjY2Vzc19rZXknLFxuICAgICdzZWNyZXRfa2V5JyxcbiAgXVxuICBcbiAgY29uc3Qgc2FuaXRpemVkOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHt9XG4gIFxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRhKSkge1xuICAgIGNvbnN0IGxvd2VyS2V5ID0ga2V5LnRvTG93ZXJDYXNlKClcbiAgICBjb25zdCBpc1NlbnNpdGl2ZSA9IHNlbnNpdGl2ZUtleXMuc29tZShzayA9PiBsb3dlcktleS5pbmNsdWRlcyhzaykpXG4gICAgXG4gICAgaWYgKGlzU2Vuc2l0aXZlICYmIGlzUHJvZHVjdGlvbikge1xuICAgICAgc2FuaXRpemVkW2tleV0gPSAnW1JFREFDVEVEXSdcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwpIHtcbiAgICAgIHNhbml0aXplZFtrZXldID0gc2FuaXRpemVGb3JMb2dnaW5nKHZhbHVlKVxuICAgIH0gZWxzZSB7XG4gICAgICBzYW5pdGl6ZWRba2V5XSA9IHZhbHVlXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gc2FuaXRpemVkXG59XG5cbi8qKlxuICogU2FmZSBsb2dnZXIgdGhhdCByZWRhY3RzIHNlbnNpdGl2ZSBpbmZvcm1hdGlvbiBpbiBwcm9kdWN0aW9uXG4gKi9cbmV4cG9ydCBjb25zdCBsb2dnZXIgPSB7XG4gIGxvZzogKC4uLmFyZ3M6IHVua25vd25bXSkgPT4ge1xuICAgIGlmICghaXNQcm9kdWN0aW9uKSB7XG4gICAgICBjb25zb2xlLmxvZyguLi5hcmdzKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbiBwcm9kdWN0aW9uLCBzYW5pdGl6ZSBsb2dzXG4gICAgICBjb25zdCBzYW5pdGl6ZWQgPSBhcmdzLm1hcChzYW5pdGl6ZUZvckxvZ2dpbmcpXG4gICAgICBjb25zb2xlLmxvZyguLi5zYW5pdGl6ZWQpXG4gICAgfVxuICB9LFxuICBcbiAgZXJyb3I6IChtZXNzYWdlOiBzdHJpbmcsIGVycm9yPzogdW5rbm93bikgPT4ge1xuICAgIGlmICghaXNQcm9kdWN0aW9uKSB7XG4gICAgICBjb25zb2xlLmVycm9yKG1lc3NhZ2UsIGVycm9yKVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBJbiBwcm9kdWN0aW9uLCBvbmx5IGxvZyBlcnJvciBtZXNzYWdlcywgbm90IGZ1bGwgZXJyb3Igb2JqZWN0c1xuICAgICAgY29uc3Qgc2FuaXRpemVkRXJyb3IgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yIFxuICAgICAgICA/IHsgbWVzc2FnZTogZXJyb3IubWVzc2FnZSwgbmFtZTogZXJyb3IubmFtZSB9XG4gICAgICAgIDogc2FuaXRpemVGb3JMb2dnaW5nKGVycm9yKVxuICAgICAgY29uc29sZS5lcnJvcihtZXNzYWdlLCBzYW5pdGl6ZWRFcnJvcilcbiAgICB9XG4gIH0sXG4gIFxuICB3YXJuOiAoLi4uYXJnczogdW5rbm93bltdKSA9PiB7XG4gICAgaWYgKCFpc1Byb2R1Y3Rpb24pIHtcbiAgICAgIGNvbnNvbGUud2FybiguLi5hcmdzKVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzYW5pdGl6ZWQgPSBhcmdzLm1hcChzYW5pdGl6ZUZvckxvZ2dpbmcpXG4gICAgICBjb25zb2xlLndhcm4oLi4uc2FuaXRpemVkKVxuICAgIH1cbiAgfSxcbiAgXG4gIGluZm86ICguLi5hcmdzOiB1bmtub3duW10pID0+IHtcbiAgICBpZiAoIWlzUHJvZHVjdGlvbikge1xuICAgICAgY29uc29sZS5pbmZvKC4uLmFyZ3MpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHNhbml0aXplZCA9IGFyZ3MubWFwKHNhbml0aXplRm9yTG9nZ2luZylcbiAgICAgIGNvbnNvbGUuaW5mbyguLi5zYW5pdGl6ZWQpXG4gICAgfVxuICB9LFxufVxuIl0sIm5hbWVzIjpbImlzUHJvZHVjdGlvbiIsInByb2Nlc3MiLCJzYW5pdGl6ZUZvckxvZ2dpbmciLCJkYXRhIiwiQXJyYXkiLCJpc0FycmF5IiwibWFwIiwic2Vuc2l0aXZlS2V5cyIsInNhbml0aXplZCIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsImxvd2VyS2V5IiwidG9Mb3dlckNhc2UiLCJpc1NlbnNpdGl2ZSIsInNvbWUiLCJzayIsImluY2x1ZGVzIiwibG9nZ2VyIiwibG9nIiwiYXJncyIsImNvbnNvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJzYW5pdGl6ZWRFcnJvciIsIkVycm9yIiwibmFtZSIsIndhcm4iLCJpbmZvIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/logger.ts\n");

/***/ }),

/***/ "(rsc)/./lib/security.ts":
/*!*************************!*\
  !*** ./lib/security.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkRateLimit: () => (/* binding */ checkRateLimit),\n/* harmony export */   getAllowedOrigins: () => (/* binding */ getAllowedOrigins),\n/* harmony export */   getClientIdentifier: () => (/* binding */ getClientIdentifier),\n/* harmony export */   getCorsHeaders: () => (/* binding */ getCorsHeaders),\n/* harmony export */   isOriginAllowed: () => (/* binding */ isOriginAllowed),\n/* harmony export */   sanitizeError: () => (/* binding */ sanitizeError)\n/* harmony export */ });\n/**\n * Security utilities for the application\n */ /**\n * Get allowed origins from environment variable\n * Format: comma-separated list of origins, e.g., \"https://example.com,https://app.example.com\"\n */ function getAllowedOrigins() {\n    const allowedOrigins = process.env.ALLOWED_ORIGINS;\n    if (!allowedOrigins) {\n        // Default to same origin in production, allow all in development\n        return  false ? 0 : [\n            \"http://localhost:3000\",\n            \"http://127.0.0.1:3000\"\n        ];\n    }\n    return allowedOrigins.split(\",\").map((origin)=>origin.trim()).filter(Boolean);\n}\n/**\n * Check if an origin is allowed\n */ function isOriginAllowed(origin) {\n    if (!origin) return false;\n    const allowedOrigins = getAllowedOrigins();\n    // In development, allow localhost\n    if (true) {\n        if (origin.startsWith(\"http://localhost\") || origin.startsWith(\"http://127.0.0.1\")) {\n            return true;\n        }\n    }\n    return allowedOrigins.includes(origin);\n}\n/**\n * Get CORS headers for a given request origin\n */ function getCorsHeaders(origin) {\n    const headers = {\n        \"Access-Control-Allow-Methods\": \"GET, POST, OPTIONS\",\n        \"Access-Control-Allow-Headers\": \"Content-Type, Authorization, X-Requested-With\",\n        \"Access-Control-Allow-Credentials\": \"true\"\n    };\n    if (origin && isOriginAllowed(origin)) {\n        headers[\"Access-Control-Allow-Origin\"] = origin;\n    } else if (true) {\n        // In development, allow the origin if it's localhost\n        headers[\"Access-Control-Allow-Origin\"] = origin || \"*\";\n    } else {}\n    return headers;\n}\n/**\n * Sanitize error messages for production\n * Prevents leaking sensitive information\n */ function sanitizeError(error, isProduction = \"development\" === \"production\") {\n    if (!isProduction) {\n        return error instanceof Error ? error.message : String(error);\n    }\n    // In production, return generic error messages\n    if (error instanceof Error) {\n        // Only expose specific error types that are safe\n        if (error.message.includes(\"not configured\") || error.message.includes(\"missing\")) {\n            return \"Configuration error. Please contact support.\";\n        }\n        return \"An error occurred. Please try again later.\";\n    }\n    return \"An error occurred. Please try again later.\";\n}\n/**\n * Rate limiting helper (in-memory, simple implementation)\n * For production, consider using Redis or a dedicated service\n */ const rateLimitStore = new Map();\nfunction checkRateLimit(identifier, maxRequests = 10, windowMs = 60000 // 1 minute\n) {\n    const now = Date.now();\n    const record = rateLimitStore.get(identifier);\n    if (!record || now > record.resetTime) {\n        // Create new record\n        const resetAt = now + windowMs;\n        rateLimitStore.set(identifier, {\n            count: 1,\n            resetTime: resetAt\n        });\n        // Cleanup old entries periodically\n        if (rateLimitStore.size > 10000) {\n            for (const [key, value] of rateLimitStore.entries()){\n                if (now > value.resetTime) {\n                    rateLimitStore.delete(key);\n                }\n            }\n        }\n        return {\n            allowed: true,\n            remaining: maxRequests - 1,\n            resetAt\n        };\n    }\n    if (record.count >= maxRequests) {\n        return {\n            allowed: false,\n            remaining: 0,\n            resetAt: record.resetTime\n        };\n    }\n    record.count++;\n    return {\n        allowed: true,\n        remaining: maxRequests - record.count,\n        resetAt: record.resetTime\n    };\n}\n/**\n * Get client identifier for rate limiting\n */ function getClientIdentifier(request) {\n    // Try to get IP from various headers (for Vercel/proxy environments)\n    const forwardedFor = request.headers.get(\"x-forwarded-for\");\n    const realIp = request.headers.get(\"x-real-ip\");\n    const ip = forwardedFor?.split(\",\")[0] || realIp || \"unknown\";\n    return ip;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc2VjdXJpdHkudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0NBRUMsR0FFRDs7O0NBR0MsR0FDTSxTQUFTQTtJQUNkLE1BQU1DLGlCQUFpQkMsUUFBUUMsR0FBRyxDQUFDQyxlQUFlO0lBRWxELElBQUksQ0FBQ0gsZ0JBQWdCO1FBQ25CLGlFQUFpRTtRQUNqRSxPQUFPQyxNQUF5QixHQUM1QixDQUFFLEdBQ0Y7WUFBQztZQUF5QjtTQUF3QjtJQUN4RDtJQUVBLE9BQU9ELGVBQWVJLEtBQUssQ0FBQyxLQUFLQyxHQUFHLENBQUNDLENBQUFBLFNBQVVBLE9BQU9DLElBQUksSUFBSUMsTUFBTSxDQUFDQztBQUN2RTtBQUVBOztDQUVDLEdBQ00sU0FBU0MsZ0JBQWdCSixNQUFxQjtJQUNuRCxJQUFJLENBQUNBLFFBQVEsT0FBTztJQUVwQixNQUFNTixpQkFBaUJEO0lBRXZCLGtDQUFrQztJQUNsQyxJQUFJRSxJQUF5QixFQUFjO1FBQ3pDLElBQUlLLE9BQU9LLFVBQVUsQ0FBQyx1QkFBdUJMLE9BQU9LLFVBQVUsQ0FBQyxxQkFBcUI7WUFDbEYsT0FBTztRQUNUO0lBQ0Y7SUFFQSxPQUFPWCxlQUFlWSxRQUFRLENBQUNOO0FBQ2pDO0FBRUE7O0NBRUMsR0FDTSxTQUFTTyxlQUFlUCxNQUFxQjtJQUNsRCxNQUFNUSxVQUFrQztRQUN0QyxnQ0FBZ0M7UUFDaEMsZ0NBQWdDO1FBQ2hDLG9DQUFvQztJQUN0QztJQUVBLElBQUlSLFVBQVVJLGdCQUFnQkosU0FBUztRQUNyQ1EsT0FBTyxDQUFDLDhCQUE4QixHQUFHUjtJQUMzQyxPQUFPLElBQUlMLElBQXlCLEVBQWM7UUFDaEQscURBQXFEO1FBQ3JEYSxPQUFPLENBQUMsOEJBQThCLEdBQUdSLFVBQVU7SUFDckQsT0FBTyxFQUdOO0lBRUQsT0FBT1E7QUFDVDtBQUVBOzs7Q0FHQyxHQUNNLFNBQVNDLGNBQWNDLEtBQWMsRUFBRUMsZUFBd0JoQixrQkFBeUIsWUFBWTtJQUN6RyxJQUFJLENBQUNnQixjQUFjO1FBQ2pCLE9BQU9ELGlCQUFpQkUsUUFBUUYsTUFBTUcsT0FBTyxHQUFHQyxPQUFPSjtJQUN6RDtJQUVBLCtDQUErQztJQUMvQyxJQUFJQSxpQkFBaUJFLE9BQU87UUFDMUIsaURBQWlEO1FBQ2pELElBQUlGLE1BQU1HLE9BQU8sQ0FBQ1AsUUFBUSxDQUFDLHFCQUFxQkksTUFBTUcsT0FBTyxDQUFDUCxRQUFRLENBQUMsWUFBWTtZQUNqRixPQUFPO1FBQ1Q7UUFDQSxPQUFPO0lBQ1Q7SUFFQSxPQUFPO0FBQ1Q7QUFFQTs7O0NBR0MsR0FDRCxNQUFNUyxpQkFBaUIsSUFBSUM7QUFFcEIsU0FBU0MsZUFDZEMsVUFBa0IsRUFDbEJDLGNBQXNCLEVBQUUsRUFDeEJDLFdBQW1CLE1BQU0sV0FBVztBQUFaO0lBRXhCLE1BQU1DLE1BQU1DLEtBQUtELEdBQUc7SUFDcEIsTUFBTUUsU0FBU1IsZUFBZVMsR0FBRyxDQUFDTjtJQUVsQyxJQUFJLENBQUNLLFVBQVVGLE1BQU1FLE9BQU9FLFNBQVMsRUFBRTtRQUNyQyxvQkFBb0I7UUFDcEIsTUFBTUMsVUFBVUwsTUFBTUQ7UUFDdEJMLGVBQWVZLEdBQUcsQ0FBQ1QsWUFBWTtZQUFFVSxPQUFPO1lBQUdILFdBQVdDO1FBQVE7UUFFOUQsbUNBQW1DO1FBQ25DLElBQUlYLGVBQWVjLElBQUksR0FBRyxPQUFPO1lBQy9CLEtBQUssTUFBTSxDQUFDQyxLQUFLQyxNQUFNLElBQUloQixlQUFlaUIsT0FBTyxHQUFJO2dCQUNuRCxJQUFJWCxNQUFNVSxNQUFNTixTQUFTLEVBQUU7b0JBQ3pCVixlQUFla0IsTUFBTSxDQUFDSDtnQkFDeEI7WUFDRjtRQUNGO1FBRUEsT0FBTztZQUFFSSxTQUFTO1lBQU1DLFdBQVdoQixjQUFjO1lBQUdPO1FBQVE7SUFDOUQ7SUFFQSxJQUFJSCxPQUFPSyxLQUFLLElBQUlULGFBQWE7UUFDL0IsT0FBTztZQUFFZSxTQUFTO1lBQU9DLFdBQVc7WUFBR1QsU0FBU0gsT0FBT0UsU0FBUztRQUFDO0lBQ25FO0lBRUFGLE9BQU9LLEtBQUs7SUFDWixPQUFPO1FBQUVNLFNBQVM7UUFBTUMsV0FBV2hCLGNBQWNJLE9BQU9LLEtBQUs7UUFBRUYsU0FBU0gsT0FBT0UsU0FBUztJQUFDO0FBQzNGO0FBRUE7O0NBRUMsR0FDTSxTQUFTVyxvQkFBb0JDLE9BQXdFO0lBQzFHLHFFQUFxRTtJQUNyRSxNQUFNQyxlQUFlRCxRQUFRN0IsT0FBTyxDQUFDZ0IsR0FBRyxDQUFDO0lBQ3pDLE1BQU1lLFNBQVNGLFFBQVE3QixPQUFPLENBQUNnQixHQUFHLENBQUM7SUFDbkMsTUFBTWdCLEtBQUtGLGNBQWN4QyxNQUFNLElBQUksQ0FBQyxFQUFFLElBQUl5QyxVQUFVO0lBRXBELE9BQU9DO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nbWMtdmVyYXNldC1hcGkvLi9saWIvc2VjdXJpdHkudHM/MTkwYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFNlY3VyaXR5IHV0aWxpdGllcyBmb3IgdGhlIGFwcGxpY2F0aW9uXG4gKi9cblxuLyoqXG4gKiBHZXQgYWxsb3dlZCBvcmlnaW5zIGZyb20gZW52aXJvbm1lbnQgdmFyaWFibGVcbiAqIEZvcm1hdDogY29tbWEtc2VwYXJhdGVkIGxpc3Qgb2Ygb3JpZ2lucywgZS5nLiwgXCJodHRwczovL2V4YW1wbGUuY29tLGh0dHBzOi8vYXBwLmV4YW1wbGUuY29tXCJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldEFsbG93ZWRPcmlnaW5zKCk6IHN0cmluZ1tdIHtcbiAgY29uc3QgYWxsb3dlZE9yaWdpbnMgPSBwcm9jZXNzLmVudi5BTExPV0VEX09SSUdJTlM7XG4gIFxuICBpZiAoIWFsbG93ZWRPcmlnaW5zKSB7XG4gICAgLy8gRGVmYXVsdCB0byBzYW1lIG9yaWdpbiBpbiBwcm9kdWN0aW9uLCBhbGxvdyBhbGwgaW4gZGV2ZWxvcG1lbnRcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyBcbiAgICAgID8gW10gXG4gICAgICA6IFsnaHR0cDovL2xvY2FsaG9zdDozMDAwJywgJ2h0dHA6Ly8xMjcuMC4wLjE6MzAwMCddO1xuICB9XG4gIFxuICByZXR1cm4gYWxsb3dlZE9yaWdpbnMuc3BsaXQoJywnKS5tYXAob3JpZ2luID0+IG9yaWdpbi50cmltKCkpLmZpbHRlcihCb29sZWFuKTtcbn1cblxuLyoqXG4gKiBDaGVjayBpZiBhbiBvcmlnaW4gaXMgYWxsb3dlZFxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNPcmlnaW5BbGxvd2VkKG9yaWdpbjogc3RyaW5nIHwgbnVsbCk6IGJvb2xlYW4ge1xuICBpZiAoIW9yaWdpbikgcmV0dXJuIGZhbHNlO1xuICBcbiAgY29uc3QgYWxsb3dlZE9yaWdpbnMgPSBnZXRBbGxvd2VkT3JpZ2lucygpO1xuICBcbiAgLy8gSW4gZGV2ZWxvcG1lbnQsIGFsbG93IGxvY2FsaG9zdFxuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgIGlmIChvcmlnaW4uc3RhcnRzV2l0aCgnaHR0cDovL2xvY2FsaG9zdCcpIHx8IG9yaWdpbi5zdGFydHNXaXRoKCdodHRwOi8vMTI3LjAuMC4xJykpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIGFsbG93ZWRPcmlnaW5zLmluY2x1ZGVzKG9yaWdpbik7XG59XG5cbi8qKlxuICogR2V0IENPUlMgaGVhZGVycyBmb3IgYSBnaXZlbiByZXF1ZXN0IG9yaWdpblxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29yc0hlYWRlcnMob3JpZ2luOiBzdHJpbmcgfCBudWxsKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gIGNvbnN0IGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiAnR0VULCBQT1NULCBPUFRJT05TJyxcbiAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6ICdDb250ZW50LVR5cGUsIEF1dGhvcml6YXRpb24sIFgtUmVxdWVzdGVkLVdpdGgnLFxuICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1DcmVkZW50aWFscyc6ICd0cnVlJyxcbiAgfTtcbiAgXG4gIGlmIChvcmlnaW4gJiYgaXNPcmlnaW5BbGxvd2VkKG9yaWdpbikpIHtcbiAgICBoZWFkZXJzWydBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nXSA9IG9yaWdpbjtcbiAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgLy8gSW4gZGV2ZWxvcG1lbnQsIGFsbG93IHRoZSBvcmlnaW4gaWYgaXQncyBsb2NhbGhvc3RcbiAgICBoZWFkZXJzWydBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nXSA9IG9yaWdpbiB8fCAnKic7XG4gIH0gZWxzZSB7XG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgZG9uJ3Qgc2V0IHRoZSBoZWFkZXIgaWYgb3JpZ2luIGlzIG5vdCBhbGxvd2VkXG4gICAgLy8gVGhpcyBlZmZlY3RpdmVseSBibG9ja3MgQ09SUyByZXF1ZXN0cyBmcm9tIHVuYXV0aG9yaXplZCBvcmlnaW5zXG4gIH1cbiAgXG4gIHJldHVybiBoZWFkZXJzO1xufVxuXG4vKipcbiAqIFNhbml0aXplIGVycm9yIG1lc3NhZ2VzIGZvciBwcm9kdWN0aW9uXG4gKiBQcmV2ZW50cyBsZWFraW5nIHNlbnNpdGl2ZSBpbmZvcm1hdGlvblxuICovXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVFcnJvcihlcnJvcjogdW5rbm93biwgaXNQcm9kdWN0aW9uOiBib29sZWFuID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyk6IHN0cmluZyB7XG4gIGlmICghaXNQcm9kdWN0aW9uKSB7XG4gICAgcmV0dXJuIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcbiAgfVxuICBcbiAgLy8gSW4gcHJvZHVjdGlvbiwgcmV0dXJuIGdlbmVyaWMgZXJyb3IgbWVzc2FnZXNcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAvLyBPbmx5IGV4cG9zZSBzcGVjaWZpYyBlcnJvciB0eXBlcyB0aGF0IGFyZSBzYWZlXG4gICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ25vdCBjb25maWd1cmVkJykgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnbWlzc2luZycpKSB7XG4gICAgICByZXR1cm4gJ0NvbmZpZ3VyYXRpb24gZXJyb3IuIFBsZWFzZSBjb250YWN0IHN1cHBvcnQuJztcbiAgICB9XG4gICAgcmV0dXJuICdBbiBlcnJvciBvY2N1cnJlZC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nO1xuICB9XG4gIFxuICByZXR1cm4gJ0FuIGVycm9yIG9jY3VycmVkLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLic7XG59XG5cbi8qKlxuICogUmF0ZSBsaW1pdGluZyBoZWxwZXIgKGluLW1lbW9yeSwgc2ltcGxlIGltcGxlbWVudGF0aW9uKVxuICogRm9yIHByb2R1Y3Rpb24sIGNvbnNpZGVyIHVzaW5nIFJlZGlzIG9yIGEgZGVkaWNhdGVkIHNlcnZpY2VcbiAqL1xuY29uc3QgcmF0ZUxpbWl0U3RvcmUgPSBuZXcgTWFwPHN0cmluZywgeyBjb3VudDogbnVtYmVyOyByZXNldFRpbWU6IG51bWJlciB9PigpO1xuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tSYXRlTGltaXQoXG4gIGlkZW50aWZpZXI6IHN0cmluZyxcbiAgbWF4UmVxdWVzdHM6IG51bWJlciA9IDEwLFxuICB3aW5kb3dNczogbnVtYmVyID0gNjAwMDAgLy8gMSBtaW51dGVcbik6IHsgYWxsb3dlZDogYm9vbGVhbjsgcmVtYWluaW5nOiBudW1iZXI7IHJlc2V0QXQ6IG51bWJlciB9IHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgcmVjb3JkID0gcmF0ZUxpbWl0U3RvcmUuZ2V0KGlkZW50aWZpZXIpO1xuICBcbiAgaWYgKCFyZWNvcmQgfHwgbm93ID4gcmVjb3JkLnJlc2V0VGltZSkge1xuICAgIC8vIENyZWF0ZSBuZXcgcmVjb3JkXG4gICAgY29uc3QgcmVzZXRBdCA9IG5vdyArIHdpbmRvd01zO1xuICAgIHJhdGVMaW1pdFN0b3JlLnNldChpZGVudGlmaWVyLCB7IGNvdW50OiAxLCByZXNldFRpbWU6IHJlc2V0QXQgfSk7XG4gICAgXG4gICAgLy8gQ2xlYW51cCBvbGQgZW50cmllcyBwZXJpb2RpY2FsbHlcbiAgICBpZiAocmF0ZUxpbWl0U3RvcmUuc2l6ZSA+IDEwMDAwKSB7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiByYXRlTGltaXRTdG9yZS5lbnRyaWVzKCkpIHtcbiAgICAgICAgaWYgKG5vdyA+IHZhbHVlLnJlc2V0VGltZSkge1xuICAgICAgICAgIHJhdGVMaW1pdFN0b3JlLmRlbGV0ZShrZXkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IGFsbG93ZWQ6IHRydWUsIHJlbWFpbmluZzogbWF4UmVxdWVzdHMgLSAxLCByZXNldEF0IH07XG4gIH1cbiAgXG4gIGlmIChyZWNvcmQuY291bnQgPj0gbWF4UmVxdWVzdHMpIHtcbiAgICByZXR1cm4geyBhbGxvd2VkOiBmYWxzZSwgcmVtYWluaW5nOiAwLCByZXNldEF0OiByZWNvcmQucmVzZXRUaW1lIH07XG4gIH1cbiAgXG4gIHJlY29yZC5jb3VudCsrO1xuICByZXR1cm4geyBhbGxvd2VkOiB0cnVlLCByZW1haW5pbmc6IG1heFJlcXVlc3RzIC0gcmVjb3JkLmNvdW50LCByZXNldEF0OiByZWNvcmQucmVzZXRUaW1lIH07XG59XG5cbi8qKlxuICogR2V0IGNsaWVudCBpZGVudGlmaWVyIGZvciByYXRlIGxpbWl0aW5nXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRDbGllbnRJZGVudGlmaWVyKHJlcXVlc3Q6IFJlcXVlc3QgfCB7IGhlYWRlcnM6IHsgZ2V0OiAobmFtZTogc3RyaW5nKSA9PiBzdHJpbmcgfCBudWxsIH0gfSk6IHN0cmluZyB7XG4gIC8vIFRyeSB0byBnZXQgSVAgZnJvbSB2YXJpb3VzIGhlYWRlcnMgKGZvciBWZXJjZWwvcHJveHkgZW52aXJvbm1lbnRzKVxuICBjb25zdCBmb3J3YXJkZWRGb3IgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKTtcbiAgY29uc3QgcmVhbElwID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJyk7XG4gIGNvbnN0IGlwID0gZm9yd2FyZGVkRm9yPy5zcGxpdCgnLCcpWzBdIHx8IHJlYWxJcCB8fCAndW5rbm93bic7XG4gIFxuICByZXR1cm4gaXA7XG59XG4iXSwibmFtZXMiOlsiZ2V0QWxsb3dlZE9yaWdpbnMiLCJhbGxvd2VkT3JpZ2lucyIsInByb2Nlc3MiLCJlbnYiLCJBTExPV0VEX09SSUdJTlMiLCJzcGxpdCIsIm1hcCIsIm9yaWdpbiIsInRyaW0iLCJmaWx0ZXIiLCJCb29sZWFuIiwiaXNPcmlnaW5BbGxvd2VkIiwic3RhcnRzV2l0aCIsImluY2x1ZGVzIiwiZ2V0Q29yc0hlYWRlcnMiLCJoZWFkZXJzIiwic2FuaXRpemVFcnJvciIsImVycm9yIiwiaXNQcm9kdWN0aW9uIiwiRXJyb3IiLCJtZXNzYWdlIiwiU3RyaW5nIiwicmF0ZUxpbWl0U3RvcmUiLCJNYXAiLCJjaGVja1JhdGVMaW1pdCIsImlkZW50aWZpZXIiLCJtYXhSZXF1ZXN0cyIsIndpbmRvd01zIiwibm93IiwiRGF0ZSIsInJlY29yZCIsImdldCIsInJlc2V0VGltZSIsInJlc2V0QXQiLCJzZXQiLCJjb3VudCIsInNpemUiLCJrZXkiLCJ2YWx1ZSIsImVudHJpZXMiLCJkZWxldGUiLCJhbGxvd2VkIiwicmVtYWluaW5nIiwiZ2V0Q2xpZW50SWRlbnRpZmllciIsInJlcXVlc3QiLCJmb3J3YXJkZWRGb3IiLCJyZWFsSXAiLCJpcCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/security.ts\n");

/***/ }),

/***/ "(rsc)/./lib/validation.ts":
/*!***************************!*\
  !*** ./lib/validation.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   analysisFiltersSchema: () => (/* binding */ analysisFiltersSchema),\n/* harmony export */   createJobSchema: () => (/* binding */ createJobSchema),\n/* harmony export */   dateRangeSchema: () => (/* binding */ dateRangeSchema),\n/* harmony export */   loginSchema: () => (/* binding */ loginSchema),\n/* harmony export */   sanitizeString: () => (/* binding */ sanitizeString),\n/* harmony export */   sanitizeStringArray: () => (/* binding */ sanitizeStringArray),\n/* harmony export */   validateRequestBody: () => (/* binding */ validateRequestBody)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/types.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/v3/ZodError.js\");\n/**\n * Validation schemas using Zod\n */ \n/**\n * Date range validation schema\n */ const dateRangeSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    from: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    to: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    from_date: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    to_date: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n}).refine((data)=>(data.from || data.from_date) && (data.to || data.to_date), {\n    message: \"Both from and to dates are required\"\n});\n/**\n * Job creation schema\n */ const createJobSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    name: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1).max(200),\n    type: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"pings\",\n        \"devices\",\n        \"aggregate\"\n    ]),\n    poiCount: zod__WEBPACK_IMPORTED_MODULE_0__.number().int().min(0).optional(),\n    poiCollectionId: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    dateRange: dateRangeSchema,\n    radius: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(1).max(1000).optional().default(10),\n    schema: zod__WEBPACK_IMPORTED_MODULE_0__[\"enum\"]([\n        \"BASIC\",\n        \"ENHANCED\",\n        \"FULL\"\n    ]).optional().default(\"BASIC\"),\n    verasetConfig: zod__WEBPACK_IMPORTED_MODULE_0__.object({\n        geo_radius: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any()).optional()\n    }).optional(),\n    pois: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.any()).optional(),\n    poiMapping: zod__WEBPACK_IMPORTED_MODULE_0__.record(zod__WEBPACK_IMPORTED_MODULE_0__.string()).optional(),\n    poiNames: zod__WEBPACK_IMPORTED_MODULE_0__.record(zod__WEBPACK_IMPORTED_MODULE_0__.string()).optional()\n});\n/**\n * Login schema\n */ const loginSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    username: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1).max(100),\n    password: zod__WEBPACK_IMPORTED_MODULE_0__.string().min(1).max(500)\n});\n/**\n * Dataset analysis filters schema\n */ const analysisFiltersSchema = zod__WEBPACK_IMPORTED_MODULE_0__.object({\n    startDate: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    endDate: zod__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    poiIds: zod__WEBPACK_IMPORTED_MODULE_0__.array(zod__WEBPACK_IMPORTED_MODULE_0__.string()).optional(),\n    minDwellMinutes: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).optional(),\n    maxDwellMinutes: zod__WEBPACK_IMPORTED_MODULE_0__.number().min(0).optional()\n}).refine((data)=>!data.minDwellMinutes || !data.maxDwellMinutes || data.minDwellMinutes <= data.maxDwellMinutes, {\n    message: \"minDwellMinutes must be less than or equal to maxDwellMinutes\",\n    path: [\n        \"minDwellMinutes\"\n    ]\n});\n/**\n * Validate and parse request body\n */ async function validateRequestBody(request, schema) {\n    try {\n        const body = await request.json();\n        const validatedData = schema.parse(body);\n        return {\n            success: true,\n            data: validatedData\n        };\n    } catch (error) {\n        if (error instanceof zod__WEBPACK_IMPORTED_MODULE_1__.ZodError) {\n            const errorMessages = error.errors.map((e)=>`${e.path.join(\".\")}: ${e.message}`).join(\", \");\n            return {\n                success: false,\n                error: `Validation error: ${errorMessages}`,\n                status: 400\n            };\n        }\n        return {\n            success: false,\n            error: \"Invalid request body\",\n            status: 400\n        };\n    }\n}\n/**\n * Sanitize string input (basic XSS prevention)\n */ function sanitizeString(input, maxLength = 1000) {\n    return input.trim().slice(0, maxLength).replace(/[<>]/g, \"\") // Remove potential HTML tags\n    ;\n}\n/**\n * Validate and sanitize array of strings\n */ function sanitizeStringArray(input, maxLength = 100) {\n    if (!Array.isArray(input)) {\n        return [];\n    }\n    return input.filter((item)=>typeof item === \"string\").map((item)=>sanitizeString(item, maxLength)).filter(Boolean);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCbkQseUNBQVUsRUFBRTtZQUMvQixNQUFNcUQsZ0JBQWdCRixNQUFNRyxNQUFNLENBQUNDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBSyxDQUFDLEVBQUVBLEVBQUViLElBQUksQ0FBQ2MsSUFBSSxDQUFDLEtBQUssRUFBRSxFQUFFRCxFQUFFN0MsT0FBTyxDQUFDLENBQUMsRUFBRThDLElBQUksQ0FBQztZQUN0RixPQUFPO2dCQUNMUCxTQUFTO2dCQUNUQyxPQUFPLENBQUMsa0JBQWtCLEVBQUVFLGNBQWMsQ0FBQztnQkFDM0NLLFFBQVE7WUFDVjtRQUNGO1FBRUEsT0FBTztZQUNMUixTQUFTO1lBQ1RDLE9BQU87WUFDUE8sUUFBUTtRQUNWO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ00sU0FBU0MsZUFBZUMsS0FBYSxFQUFFQyxZQUFvQixJQUFJO0lBQ3BFLE9BQU9ELE1BQ0pFLElBQUksR0FDSkMsS0FBSyxDQUFDLEdBQUdGLFdBQ1RHLE9BQU8sQ0FBQyxTQUFTLElBQUksNkJBQTZCOztBQUN2RDtBQUVBOztDQUVDLEdBQ00sU0FBU0Msb0JBQW9CTCxLQUFjLEVBQUVDLFlBQW9CLEdBQUc7SUFDekUsSUFBSSxDQUFDSyxNQUFNQyxPQUFPLENBQUNQLFFBQVE7UUFDekIsT0FBTyxFQUFFO0lBQ1g7SUFFQSxPQUFPQSxNQUNKUSxNQUFNLENBQUMsQ0FBQ0MsT0FBeUIsT0FBT0EsU0FBUyxVQUNqRGQsR0FBRyxDQUFDYyxDQUFBQSxPQUFRVixlQUFlVSxNQUFNUixZQUNqQ08sTUFBTSxDQUFDRTtBQUNaIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ21jLXZlcmFzZXQtYXBpLy4vbGliL3ZhbGlkYXRpb24udHM/NTBhYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFZhbGlkYXRpb24gc2NoZW1hcyB1c2luZyBab2RcbiAqL1xuXG5pbXBvcnQgeyB6IH0gZnJvbSAnem9kJ1xuXG4vKipcbiAqIERhdGUgcmFuZ2UgdmFsaWRhdGlvbiBzY2hlbWFcbiAqL1xuZXhwb3J0IGNvbnN0IGRhdGVSYW5nZVNjaGVtYSA9IHoub2JqZWN0KHtcbiAgZnJvbTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICB0bzogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBmcm9tX2RhdGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdG9fZGF0ZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxufSkucmVmaW5lKFxuICAoZGF0YSkgPT4gKGRhdGEuZnJvbSB8fCBkYXRhLmZyb21fZGF0ZSkgJiYgKGRhdGEudG8gfHwgZGF0YS50b19kYXRlKSxcbiAgeyBtZXNzYWdlOiAnQm90aCBmcm9tIGFuZCB0byBkYXRlcyBhcmUgcmVxdWlyZWQnIH1cbilcblxuLyoqXG4gKiBKb2IgY3JlYXRpb24gc2NoZW1hXG4gKi9cbmV4cG9ydCBjb25zdCBjcmVhdGVKb2JTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIG5hbWU6IHouc3RyaW5nKCkubWluKDEpLm1heCgyMDApLFxuICB0eXBlOiB6LmVudW0oWydwaW5ncycsICdkZXZpY2VzJywgJ2FnZ3JlZ2F0ZSddKSxcbiAgcG9pQ291bnQ6IHoubnVtYmVyKCkuaW50KCkubWluKDApLm9wdGlvbmFsKCksXG4gIHBvaUNvbGxlY3Rpb25JZDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBkYXRlUmFuZ2U6IGRhdGVSYW5nZVNjaGVtYSxcbiAgcmFkaXVzOiB6Lm51bWJlcigpLm1pbigxKS5tYXgoMTAwMCkub3B0aW9uYWwoKS5kZWZhdWx0KDEwKSxcbiAgc2NoZW1hOiB6LmVudW0oWydCQVNJQycsICdFTkhBTkNFRCcsICdGVUxMJ10pLm9wdGlvbmFsKCkuZGVmYXVsdCgnQkFTSUMnKSxcbiAgdmVyYXNldENvbmZpZzogei5vYmplY3Qoe1xuICAgIGdlb19yYWRpdXM6IHouYXJyYXkoei5hbnkoKSkub3B0aW9uYWwoKSxcbiAgfSkub3B0aW9uYWwoKSxcbiAgcG9pczogei5hcnJheSh6LmFueSgpKS5vcHRpb25hbCgpLFxuICBwb2lNYXBwaW5nOiB6LnJlY29yZCh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICBwb2lOYW1lczogei5yZWNvcmQoei5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbn0pXG5cbi8qKlxuICogTG9naW4gc2NoZW1hXG4gKi9cbmV4cG9ydCBjb25zdCBsb2dpblNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdXNlcm5hbWU6IHouc3RyaW5nKCkubWluKDEpLm1heCgxMDApLFxuICBwYXNzd29yZDogei5zdHJpbmcoKS5taW4oMSkubWF4KDUwMCksXG59KVxuXG4vKipcbiAqIERhdGFzZXQgYW5hbHlzaXMgZmlsdGVycyBzY2hlbWFcbiAqL1xuZXhwb3J0IGNvbnN0IGFuYWx5c2lzRmlsdGVyc1NjaGVtYSA9IHoub2JqZWN0KHtcbiAgc3RhcnREYXRlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGVuZERhdGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgcG9pSWRzOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKCksXG4gIG1pbkR3ZWxsTWludXRlczogei5udW1iZXIoKS5taW4oMCkub3B0aW9uYWwoKSxcbiAgbWF4RHdlbGxNaW51dGVzOiB6Lm51bWJlcigpLm1pbigwKS5vcHRpb25hbCgpLFxufSkucmVmaW5lKFxuICAoZGF0YSkgPT4gIWRhdGEubWluRHdlbGxNaW51dGVzIHx8ICFkYXRhLm1heER3ZWxsTWludXRlcyB8fCBkYXRhLm1pbkR3ZWxsTWludXRlcyA8PSBkYXRhLm1heER3ZWxsTWludXRlcyxcbiAgeyBtZXNzYWdlOiAnbWluRHdlbGxNaW51dGVzIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIG1heER3ZWxsTWludXRlcycsIHBhdGg6IFsnbWluRHdlbGxNaW51dGVzJ10gfVxuKVxuXG4vKipcbiAqIFZhbGlkYXRlIGFuZCBwYXJzZSByZXF1ZXN0IGJvZHlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlUmVxdWVzdEJvZHk8VD4oXG4gIHJlcXVlc3Q6IFJlcXVlc3QsXG4gIHNjaGVtYTogei5ab2RTY2hlbWE8VD5cbik6IFByb21pc2U8eyBzdWNjZXNzOiB0cnVlOyBkYXRhOiBUIH0gfCB7IHN1Y2Nlc3M6IGZhbHNlOyBlcnJvcjogc3RyaW5nOyBzdGF0dXM6IG51bWJlciB9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IHNjaGVtYS5wYXJzZShib2R5KVxuICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IHZhbGlkYXRlZERhdGEgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIHouWm9kRXJyb3IpIHtcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPSBlcnJvci5lcnJvcnMubWFwKGUgPT4gYCR7ZS5wYXRoLmpvaW4oJy4nKX06ICR7ZS5tZXNzYWdlfWApLmpvaW4oJywgJylcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogYFZhbGlkYXRpb24gZXJyb3I6ICR7ZXJyb3JNZXNzYWdlc31gLFxuICAgICAgICBzdGF0dXM6IDQwMCxcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdJbnZhbGlkIHJlcXVlc3QgYm9keScsXG4gICAgICBzdGF0dXM6IDQwMCxcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBTYW5pdGl6ZSBzdHJpbmcgaW5wdXQgKGJhc2ljIFhTUyBwcmV2ZW50aW9uKVxuICovXG5leHBvcnQgZnVuY3Rpb24gc2FuaXRpemVTdHJpbmcoaW5wdXQ6IHN0cmluZywgbWF4TGVuZ3RoOiBudW1iZXIgPSAxMDAwKTogc3RyaW5nIHtcbiAgcmV0dXJuIGlucHV0XG4gICAgLnRyaW0oKVxuICAgIC5zbGljZSgwLCBtYXhMZW5ndGgpXG4gICAgLnJlcGxhY2UoL1s8Pl0vZywgJycpIC8vIFJlbW92ZSBwb3RlbnRpYWwgSFRNTCB0YWdzXG59XG5cbi8qKlxuICogVmFsaWRhdGUgYW5kIHNhbml0aXplIGFycmF5IG9mIHN0cmluZ3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplU3RyaW5nQXJyYXkoaW5wdXQ6IHVua25vd24sIG1heExlbmd0aDogbnVtYmVyID0gMTAwKTogc3RyaW5nW10ge1xuICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XG4gICAgcmV0dXJuIFtdXG4gIH1cbiAgXG4gIHJldHVybiBpbnB1dFxuICAgIC5maWx0ZXIoKGl0ZW0pOiBpdGVtIGlzIHN0cmluZyA9PiB0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpXG4gICAgLm1hcChpdGVtID0+IHNhbml0aXplU3RyaW5nKGl0ZW0sIG1heExlbmd0aCkpXG4gICAgLmZpbHRlcihCb29sZWFuKVxufVxuIl0sIm5hbWVzIjpbInoiLCJkYXRlUmFuZ2VTY2hlbWEiLCJvYmplY3QiLCJmcm9tIiwic3RyaW5nIiwib3B0aW9uYWwiLCJ0byIsImZyb21fZGF0ZSIsInRvX2RhdGUiLCJyZWZpbmUiLCJkYXRhIiwibWVzc2FnZSIsImNyZWF0ZUpvYlNjaGVtYSIsIm5hbWUiLCJtaW4iLCJtYXgiLCJ0eXBlIiwiZW51bSIsInBvaUNvdW50IiwibnVtYmVyIiwiaW50IiwicG9pQ29sbGVjdGlvbklkIiwiZGF0ZVJhbmdlIiwicmFkaXVzIiwiZGVmYXVsdCIsInNjaGVtYSIsInZlcmFzZXRDb25maWciLCJnZW9fcmFkaXVzIiwiYXJyYXkiLCJhbnkiLCJwb2lzIiwicG9pTWFwcGluZyIsInJlY29yZCIsInBvaU5hbWVzIiwibG9naW5TY2hlbWEiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiYW5hbHlzaXNGaWx0ZXJzU2NoZW1hIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInBvaUlkcyIsIm1pbkR3ZWxsTWludXRlcyIsIm1heER3ZWxsTWludXRlcyIsInBhdGgiLCJ2YWxpZGF0ZVJlcXVlc3RCb2R5IiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwidmFsaWRhdGVkRGF0YSIsInBhcnNlIiwic3VjY2VzcyIsImVycm9yIiwiWm9kRXJyb3IiLCJlcnJvck1lc3NhZ2VzIiwiZXJyb3JzIiwibWFwIiwiZSIsImpvaW4iLCJzdGF0dXMiLCJzYW5pdGl6ZVN0cmluZyIsImlucHV0IiwibWF4TGVuZ3RoIiwidHJpbSIsInNsaWNlIiwicmVwbGFjZSIsInNhbml0aXplU3RyaW5nQXJyYXkiLCJBcnJheSIsImlzQXJyYXkiLCJmaWx0ZXIiLCJpdGVtIiwiQm9vbGVhbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/validation.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/zod"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Flogin%2Froute&page=%2Fapi%2Fauth%2Flogin%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Flogin%2Froute.ts&appDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fjuliangarritz%2Fdev%2Fpy%2Fveraset%2Fveraset-api&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();